function corr = corr_PBC(L,Jmaxpos_vec,Si,Sj,u,w,VMDH,SzL,SzR,chi_inc)
%corr = corr_PBC(L,Jmaxpos_vec,Si,Sj,u,w,VMDH,SzL,SzR,chi_inc)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% dMERA - corr_PBC
% contracts two-point correlation function for disordered MERA 
% allows creation of 3 and 4-site operators
% 
% Andrew Goldsborough - 05/10/2016
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%contraction orders from netcon
h_1_order = {[-3,5,3,4],[3,1],[-1,-2,5,6],[-4,6,2,4],[2,1]};
h_2_order = {[-1,13,12,14],[12,1],[1,10,-3,11],[14,8,10,9],[13,6,8,7],[4,7,5,9],[-2,6,3,4],[3,2],[2,5,-4,11]};
h_3_order = {[-1,13,12,14],[12,1],[1,8,-3,9],[14,5,8,6],[5,3,6,4],[10,3,7,4],[-2,13,11,10],[11,2],[2,7,-4,9]};
h_4_order = {[-1,13,12,14],[12,1],[1,8,-3,9],[14,6,8,7],[7,4,9,5],[10,6,3,4],[-2,13,11,10],[11,2],[2,3,-4,5]};
h_5_order = {[1,3],[3,4,-1,5],[5,6,-3,-4],[2,4,-2,6],[1,2]};
corr_order = {[-1,15,14,16],[14,1],[1,12,-3,13],[16,10,12,11],[15,8,10,9],[11,6,13,7],[4,9,5,6],[-2,8,3,4],[3,2],[2,5,-4,7]};
make3_1_order = {[-3,14,12,13],[12,1],[1,8,-5,9],[13,5,8,6],[-1,-2,14,15],[5,3,6,4],[10,3,7,4],[-4,15,11,10],[11,2],[2,7,-6,9]};
make3_2_order = {[-3,14,12,13],[12,1],[1,8,-5,9],[13,6,8,7],[-1,-2,14,15],[7,4,9,5],[10,6,3,4],[-4,15,11,10],[11,2],[2,3,-6,5]};
make3_3_order = {[-1,8,1,9],[1,12],[12,13,-3,14],[9,6,13,7],[8,4,6,5],[14,15,-5,-6],[3,5,10,7],[-2,4,2,3],[2,11],[11,10,-4,15]};
make3_4_order = {[-1,8,1,9],[1,12],[12,13,-3,14],[9,5,13,6],[5,3,6,4],[14,15,-5,-6],[7,3,10,4],[-2,8,2,7],[2,11],[11,10,-4,15]};
prop3_1_order = {[-1,-2,-3,-4,5,6],[-5,5,3,4],[3,1],[-6,6,2,4],[2,1]};
prop3_2_order = {[-3,11,3,4],[3,1],[1,2,-5,9],[4,12,2,10],[-1,-2,11,13,12,14],[7,14,8,10],[-4,13,6,7],[6,5],[5,8,-6,9]};
prop3_3_order = {[-1,14,13,15],[13,1],[1,11,-3,12],[15,9,11,10],[14,5,9,3,10,4],[6,3,7,4],[-2,5,2,6],[2,8],[8,7,-4,12]};
prop3_4_order = {[-1,14,13,15],[13,1],[1,9,-3,10],[15,7,9,8],[7,3,8,4,10,5],[11,3,6,4],[-2,14,12,11],[12,2],[2,6,-4,5]};
prop3_5_order = {[-1,9,3,4],[3,1],[1,2,-3,11],[4,10,2,12],[12,13,11,14,-5,-6],[7,10,8,13],[-2,9,6,7],[6,5],[5,8,-4,14]};
prop3_6_order = {[1,3],[3,4,-1,5],[5,6,-3,-4,-5,-6],[2,4,-2,6],[1,2]};
make4_order = {[-3,2,9,3],[9,4],[4,6,-5,7],[-1,-2,2,1],[7,8,-7,-8],[-4,1,10,3],[10,5],[5,6,-6,8]};
prop4_1_order = {[-1,-2,-3,-4,-5,-6,5,6],[-7,5,3,4],[3,1],[-8,6,2,4],[2,1]};
prop4_2_order = {[-5,11,3,4],[3,1],[1,2,-7,9],[4,12,2,10],[-1,-2,-3,-4,11,13,12,14],[7,14,8,10],[-6,13,6,7],[6,5],[5,8,-8,9]};
prop4_3_order = {[-3,12,3,4],[3,1],[1,2,-5,13],[4,14,2,15],[-1,-2,12,8,14,6,15,7],[9,6,10,7],[-4,8,5,9],[5,11],[11,10,-6,13]};
prop4_4_order = {[-1,15,14,16],[14,1],[1,12,-3,13],[16,10,12,11],[15,6,10,7,11,8,13,9],[4,7,5,8],[-2,6,3,4],[3,2],[2,5,-4,9]};
prop4_5_order = {[-1,12,3,4],[3,1],[1,2,-3,13],[4,14,2,15],[14,6,15,7,13,8,-5,-6],[10,6,9,7],[-2,12,11,10],[11,5],[5,9,-4,8]};
prop4_6_order = {[-1,9,3,4],[3,1],[1,2,-3,11],[4,10,2,12],[12,13,11,14,-5,-6,-7,-8],[7,10,8,13],[-2,9,6,7],[6,5],[5,8,-4,14]};
prop4_7_order = {[1,3],[3,4,-1,5],[5,6,-3,-4,-5,-6,-7,-8],[2,4,-2,6],[1,2]};
prop4_PBC6_order = {[-3,7,5,1],[5,2],[2,4,-5,8],[8,10,-7,-8,-1,-2,7,9],[-4,9,6,1],[6,3],[3,4,-6,10]};
h_1_inc_order = {[-3,2,1],[-1,-2,2,3],[-4,3,1]};
h_2_inc_order = {[-1,7,8],[-3,9,1],[8,5,9,6],[7,3,5,4],[2,4,10,6],[-2,3,2],[-4,10,1]};
h_3_inc_order = {[-1,1,9],[-3,7,2],[9,5,7,6],[5,3,6,4],[10,3,8,4],[-2,1,10],[-4,8,2]};
h_4_inc_order = {[-1,1,9],[-3,7,8],[9,5,7,6],[6,3,8,4],[10,5,2,3],[-2,1,10],[-4,2,4]};
h_5_inc_order = {[-1,1,2],[2,3,-3,-4],[-2,1,3]};
corr_inc_order = {[-1,11,12],[-3,2,1],[12,7,2,3],[11,6,7,5],[3,8,1,9],[4,5,10,8],[-2,6,4],[-4,10,9]};
make3_1_inc_order = {[-3,1,10],[-5,7,2],[10,5,7,6],[-1,-2,1,11],[5,3,6,4],[9,3,8,4],[-4,11,9],[-6,8,2]};
make3_2_inc_order = {[-3,1,10],[-5,7,8],[10,5,7,6],[-1,-2,1,11],[6,3,8,4],[9,5,2,3],[-4,11,9],[-6,2,4]};
make3_3_inc_order = {[-1,7,8],[-3,10,1],[8,5,10,6],[7,3,5,4],[1,11,-5,-6],[2,4,9,6],[-2,3,2],[-4,9,11]};
make3_4_inc_order = {[-1,2,7],[-3,10,1],[7,5,10,6],[5,3,6,4],[1,11,-5,-6],[8,3,9,4],[-2,2,8],[-4,9,11]};
prop3_1_inc_order = {[-1,-2,-3,-4,2,3],[-5,2,1],[-6,3,1]};
prop3_2_inc_order = {[-3,6,2],[-5,9,1],[2,7,9,8],[-1,-2,6,4,7,5],[3,5,10,8],[-4,4,3],[-6,10,1]};
prop3_3_inc_order = {[-1,8,9],[-3,10,1],[9,6,10,7],[8,3,6,4,7,5],[2,4,11,5],[-2,3,2],[-4,11,1]};
prop3_4_inc_order = {[-1,1,10],[-3,8,9],[10,6,8,7],[6,3,7,4,9,5],[11,3,2,4],[-2,1,11],[-4,2,5]};
prop3_5_inc_order = {[-1,1,9],[-3,2,6],[9,7,2,8],[8,4,6,5,-5,-6],[10,7,3,4],[-2,1,10],[-4,3,5]};
prop3_6_inc_order = {[-1,1,2],[-2,1,3],[2,3,-3,-4,-5,-6]};
prop4_1_inc_order = {[-1,-2,-3,-4,-5,-6,2,3],[-7,2,1],[-8,3,1]};
prop4_2_inc_order = {[-5,6,2],[-7,9,1],[2,7,9,8],[-1,-2,-3,-4,6,4,7,5],[3,5,10,8],[-6,4,3],[-8,10,1]};
prop4_3_inc_order = {[-3,7,2],[-5,10,1],[2,8,10,9],[-1,-2,7,4,8,5,9,6],[3,5,11,6],[-4,4,3],[-6,11,1]};
prop4_4_inc_order = {[-1,11,12],[-3,1,8],[12,9,1,10],[11,4,9,5,10,6,8,7],[3,5,2,6],[-2,4,3],[-4,2,7]};
prop4_5_inc_order = {[-1,1,10],[-3,2,7],[10,8,2,9],[8,4,9,5,7,6,-5,-6],[11,4,3,5],[-2,1,11],[-4,3,6]};
prop4_6_inc_order = {[-1,1,9],[-3,2,6],[9,7,2,8],[8,4,6,5,-5,-6,-7,-8],[10,7,3,4],[-2,1,10],[-4,3,5]};
prop4_7_inc_order = {[-1,1,2],[2,3,-3,-4,-5,-6,-7,-8],[-2,1,3]};
prop4_PBC6_inc_order = {[-3,5,1],[-5,2,3],[3,4,-7,-8,-1,-2,5,6],[-4,6,1],[-6,2,4]};
corr_PBC1_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[13,11,15,12],[16,9,14,10],[7,12,8,9],[6,10,5,11],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
corr_PBC2_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[15,12,16,9],[14,10,13,11],[7,12,8,9],[6,10,5,11],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
h_PBC1_at_order = {[17,18],[13,14],[14,15,17,16],[18,11,13,12],[12,10,15,9],[10,8,9,7],[6,8,5,7],[4,5,3,16],[2,11,1,6],[3,2],[1,4]};
h_PBC2_at_order = {[21,22],[17,18],[18,19,21,20],[22,15,17,16],[20,13,15,14],[16,12,19,11],[11,9,13,10],[7,10,8,14],[6,12,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
h_PBC3_at_order = {[17,18],[13,14],[14,15,17,16],[18,11,13,12],[16,9,11,10],[9,7,10,8],[5,7,6,8],[4,15,3,5],[2,6,1,12],[3,2],[1,4]};
h_PBC4_at_order = {[21,22],[17,18],[18,19,21,20],[22,15,17,16],[20,13,15,14],[16,12,19,11],[14,9,12,10],[7,13,8,9],[6,10,5,11],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop3_PBC1_at_order = {[22,23],[18,19],[19,20,22,21],[23,16,18,17],[21,14,16,15],[17,13,20,12],[15,10,13,11,12,9],[7,14,8,10],[6,11,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop3_PBC2_at_order = {[22,23],[18,19],[19,20,22,21],[23,16,18,17],[21,14,16,15],[17,13,20,12],[13,11,12,9,14,10],[7,10,8,15],[6,11,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop3_PBC3_at_order = {[22,23],[18,19],[19,20,22,21],[23,16,18,17],[21,14,16,15],[17,13,20,12],[12,9,14,10,15,11],[7,10,8,11],[6,13,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop3_PBC4_at_order = {[22,23],[18,19],[19,20,22,21],[23,16,18,17],[21,14,16,15],[17,13,20,12],[14,9,15,10,13,11],[7,9,8,10],[6,11,5,12],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop4_PBC1_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[15,10,16,11,14,12,13,9],[7,10,8,11],[6,12,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop4_PBC2_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[16,11,14,12,13,9,15,10],[7,10,8,11],[6,12,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop4_PBC3_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[14,12,13,9,15,10,16,11],[7,10,8,11],[6,12,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};
prop4_PBC4_at_order = {[23,24],[19,20],[20,21,23,22],[24,17,19,18],[22,15,17,16],[18,14,21,13],[13,9,15,10,16,11,14,12],[7,10,8,11],[6,12,5,9],[4,5,3,7],[2,8,1,6],[3,2],[1,4]};

%flag for two sites having combined and size of operator
if min(PBC_pos(Si-Sj,L),PBC_pos(Sj-Si,L)) == 1
    %neighbours are trivially successful
    combined = 2;
else
    combined = 0;

    %check left and right are correct
    if Si > Sj
        %swap L and R
        temp = Sj;
        Sj = Si;
        Si = temp;
        temp = SzR;
        SzR = SzL;
        SzL = temp;
    end
end

%run over algorithm
for iteration = 1:(L/2)-2
    
    %store current length and position
    Lcur = L-2*(iteration-1);
    Jmaxpos = Jmaxpos_vec(iteration);
    
    %check combined
    if combined == 0
        %%% not combined %%%
        
        %%% update both together %%%
        if min(mod(Si-Jmaxpos,Lcur),mod(Jmaxpos-Si,Lcur)) <= 2 && min(mod(Sj-Jmaxpos,Lcur),mod(Jmaxpos-Sj,Lcur)) <= 2
            
            %check left and right are correct
            if PBC_pos(Sj-Jmaxpos+3,Lcur) < PBC_pos(Si-Jmaxpos+3,Lcur)
                %swap L and R
                temp = Sj;
                Sj = Si;
                Si = temp;
                temp = SzR;
                SzR = SzL;
                SzL = temp;
            end
            
            if Si == PBC_pos(Jmaxpos-1,Lcur) && Sj == PBC_pos(Jmaxpos+1,Lcur)
                %store as L
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},corr_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},corr_inc_order);
                end
                
                %remove two sites
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 1,Lcur-2);
                end
                
                Sj = 0;
                combined = 2;
                
            elseif Si == PBC_pos(Jmaxpos-2,Lcur) && Sj == PBC_pos(Jmaxpos+2,Lcur)
                if chi_inc(iteration) == 0
                    %4-site operator
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},SzL,SzR,...
                        conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},make4_order);
                    
                    %remove two sites set 4-flag
                    if Jmaxpos == Lcur
                        Si = PBC_pos(Jmaxpos - 3,Lcur-2);
                    else
                        Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                    end
                    
                    Sj = 0;
                    combined = 4;
                    
                else %chi_inc(iteration) == 1
                    %splits into two
                    %diagram 1: leftmost
                    SzL = ncon({w{iteration,1},SzL,conj(w{iteration,1})},h_1_inc_order);
                    
                    %diagram 5 rightmost
                    SzR = ncon({w{iteration,2},SzR,conj(w{iteration,2})},h_5_inc_order);
                    
                    %remove two sites
                    if Jmaxpos == Lcur
                        Si = PBC_pos(Jmaxpos - 3,Lcur-2);
                        Sj = 1;
                    else
                        Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                        Sj = PBC_pos(Jmaxpos,Lcur-2);
                    end
                end
                
            elseif Si == PBC_pos(Jmaxpos-2,Lcur) && Sj == PBC_pos(Jmaxpos,Lcur)
                %creates a 3-site operator (1)
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},make3_1_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},make3_1_inc_order);
                end
                
                %remove two sites, set 3 flag
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 3,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                end
                
                Sj = 0;
                combined = 3;
                
            elseif Si == PBC_pos(Jmaxpos-2,Lcur) && Sj == PBC_pos(Jmaxpos+1,Lcur)
                %creates a 3-site operator (2)
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},make3_2_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},make3_2_inc_order);
                end
                
                %remove two sites, set 3 flag
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 3,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                end
                
                Sj = 0;
                combined = 3;
                
            elseif Si == PBC_pos(Jmaxpos-1,Lcur) && Sj == PBC_pos(Jmaxpos+2,Lcur)
                %creates a 3-site operator (3)
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},make3_3_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},make3_3_inc_order);
                end
                
                %remove two sites, set 3 flag
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 1,Lcur-2);
                end
                
                Sj = 0;
                combined = 3;
                
            elseif Si == PBC_pos(Jmaxpos,Lcur) && Sj == PBC_pos(Jmaxpos+2,Lcur)
                %creates a 3-site operator (4)
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},make3_4_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,SzR,...
                        conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},make3_4_inc_order);
                end
                
                %remove two sites, set 3 flag
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 1,Lcur-2);
                end
                
                Sj = 0;
                combined = 3;
            end
            
            %%% just update SzL %%%
        elseif Si == PBC_pos(Jmaxpos - 2,Lcur)
            %diagram 1: leftmost
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,SzL,conj(w{iteration,1}),conj(VMDH)},h_1_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},SzL,conj(w{iteration,1})},h_1_inc_order);
            end
            
            Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            Sj = PBC_pos(Sj - 2,Lcur-2);
        elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
            %diagram 2: left
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_2_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_2_inc_order);
            end
            
            %remove two sites
            Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            Sj = PBC_pos(Sj - 2,Lcur-2);
        elseif Si == Jmaxpos
            %diagram 3: centre
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_3_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_3_inc_order);
            end
            
            %remove two sites
            Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            Sj = PBC_pos(Sj - 2,Lcur-2);
        elseif Si == PBC_pos(Jmaxpos + 1,Lcur)
            %diagram 4: right
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_4_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_4_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos-2,Lcur-2);
                Sj = PBC_pos(Sj - 1,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos-1,Lcur-2);
                Sj = PBC_pos(Sj - 2,Lcur-2);
            end
            
        elseif Si == PBC_pos(Jmaxpos + 2,Lcur)
            %diagram 5 rightmost
            if chi_inc(iteration) == 0
                SzL = ncon({VMDH,w{iteration,2},SzL,conj(w{iteration,2}),conj(VMDH)},h_5_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,2},SzL,conj(w{iteration,2})},h_5_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos-1,Lcur-2);
                Sj = PBC_pos(Sj - 1,Lcur-2);
            elseif Jmaxpos == Lcur-1
                %no change in indices
            else
                Si = PBC_pos(Jmaxpos,Lcur-2);
                Sj = PBC_pos(Sj - 2,Lcur-2);
            end
            
            %%% just update SzR %%%
        elseif Sj == PBC_pos(Jmaxpos - 2,Lcur)
            %diagram 1: leftmost
            if chi_inc(iteration) == 0
                SzR = ncon({w{iteration,1},VMDH,SzR,conj(w{iteration,1}),conj(VMDH)},h_1_order);
            else %chi_inc(iteration) == 1
                SzR = ncon({w{iteration,1},SzR,conj(w{iteration,1})},h_1_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Si - 1,Lcur-2);
                Sj = PBC_pos(Jmaxpos - 3,Lcur-2);
            elseif Jmaxpos == 1
                Si = PBC_pos(Si - 2,Lcur-2);
                Sj = Lcur - 3;
            elseif Jmaxpos == 2
                Si = PBC_pos(Si - 2,Lcur-2);
                Sj = Lcur - 2;
            else
                Sj = PBC_pos(Jmaxpos - 2,Lcur-2);
            end
            
        elseif Sj == PBC_pos(Jmaxpos - 1,Lcur)
            %diagram 2: left
            if chi_inc(iteration) == 0
                SzR = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_2_order);
            else %chi_inc(iteration) == 1
                SzR = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_2_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Si - 1,Lcur-2);
                Sj = PBC_pos(Jmaxpos - 2,Lcur-2);
            elseif Jmaxpos == 1
                Si = PBC_pos(Si - 2,Lcur-2);
                Sj = Lcur - 2;
            else
                Sj = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
        elseif Sj == Jmaxpos
            %diagram 3: centre
            if chi_inc(iteration) == 0
                SzR = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_3_order);
            else %chi_inc(iteration) == 1
                SzR = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_3_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Si - 1,Lcur-2);
                Sj = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Sj = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
        elseif Sj == PBC_pos(Jmaxpos + 1,Lcur)
            %diagram 4: right
            if chi_inc(iteration) == 0
                SzR = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_4_order);
            else %chi_inc(iteration) == 1
                SzR = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzR,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_4_inc_order);
            end
            
            %remove two sites
            Sj = PBC_pos(Jmaxpos - 1,Lcur-2);
        elseif Sj == PBC_pos(Jmaxpos + 2,Lcur)
            %diagram 5 rightmost
            if chi_inc(iteration) == 0
                SzR = ncon({VMDH,w{iteration,2},SzR,conj(w{iteration,2}),conj(VMDH)},h_5_order);
            else %chi_inc(iteration) == 1
                SzR = ncon({w{iteration,2},SzR,conj(w{iteration,2})},h_5_inc_order);
            end
            
            %remove two sites
            Sj = PBC_pos(Jmaxpos,Lcur-2);
        else
            %no update
            if Jmaxpos < Si
                %two sites removed from the left of both sites
                Si = Si - 2;
                Sj = Sj - 2;
            elseif Jmaxpos == Lcur
                %remove one site from the left one from the right
                Si = Si - 1;
                Sj = Sj - 1;
            elseif Jmaxpos > Sj
                %to the right of both sites => no action
            else
                Sj = Sj - 2;
            end
        end
        
        %check if L and R have swapped
        if Si > Sj && Sj ~= 0
            temp = Sj;
            Sj = Si;
            Si = temp;
            temp = SzR;
            SzR = SzL;
            SzL = temp;
        end
        
    elseif combined == 2
        %%% combined, 2 site %%%
        
        %just update SzL
        if Si == PBC_pos(Jmaxpos - 2,Lcur)
            %diagram 1: leftmost
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,SzL,conj(w{iteration,1}),conj(VMDH)},h_1_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},SzL,conj(w{iteration,1})},h_1_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 3,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
            %diagram 2: left
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_2_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_2_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
        elseif Si == Jmaxpos
            %diagram 3: centre
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_3_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_3_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos + 1,Lcur)
            %diagram 4: right
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},h_4_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},h_4_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos + 2,Lcur)
            %diagram 5 rightmost
            if chi_inc(iteration) == 0
                SzL = ncon({VMDH,w{iteration,2},SzL,conj(w{iteration,2}),conj(VMDH)},h_5_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,2},SzL,conj(w{iteration,2})},h_5_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos,Lcur-2);
            end
        else
            %no update
            if Jmaxpos < Si
                %two sites removed from the left of both sites
                Si = Si - 2;
            elseif Jmaxpos == Lcur
                %remove one site from the left one from the right
                Si = Si - 1;
                
                %to the right of both sites => no action
            end
        end
    elseif combined == 3
        %%% combined, 3 site %%%
        
        %just update SzL
        if Si == PBC_pos(Jmaxpos - 3,Lcur)
            %propagate 3 (1)
            if chi_inc(iteration) == 0
                SzL = ncon({SzL,w{iteration,1},VMDH,conj(w{iteration,1}),conj(VMDH)},prop3_1_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({SzL,w{iteration,1},conj(w{iteration,1})},prop3_1_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 4,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 3,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos - 2,Lcur)
            %propagate 3 (2)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop3_2_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop3_2_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 3,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
            %propagate 3 (3)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop3_3_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop3_3_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
            %now a two-site operator
            combined = 2;
        elseif Si == Jmaxpos
            %propagate 3 (4)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop3_4_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop3_4_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
            %now a two-site operator
            combined = 2;
        elseif Si == PBC_pos(Jmaxpos + 1,Lcur)
            %propagate 3 (5)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop3_5_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop3_5_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
        elseif Si == PBC_pos(Jmaxpos + 2,Lcur)
            %propagate 3 (6)
            if chi_inc(iteration) == 0
                SzL = ncon({VMDH,w{iteration,2},SzL,conj(w{iteration,2}),conj(VMDH)},prop3_6_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,2},conj(w{iteration,2}),SzL},prop3_6_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos,Lcur-2);
            end
        else
            %no update
            if Jmaxpos < Si
                %two sites removed from the left of both sites
                Si = Si - 2;
            elseif Jmaxpos == Lcur
                %remove one site from the left one from the right
                Si = Si - 1;
                
                %to the right of both sites => no action
            end
        end
    else %combined == 4
        %%% combined, 4 site %%%
        
        %just update SzL
        if Si == PBC_pos(Jmaxpos - 4,Lcur)
            if Lcur == 6
                %PBC term (6)
                if chi_inc(iteration) == 0
                    SzL = ncon({w{iteration,1},VMDH,w{iteration,2},SzL,...
                        conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_PBC6_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({w{iteration,1},w{iteration,2},SzL,...
                        conj(w{iteration,1}),conj(w{iteration,2})},prop4_PBC6_inc_order);
                end
                
                %remove two sites
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 3,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 2,Lcur-2);
                end
            else
                %propagate 4 (1)
                if chi_inc(iteration) == 0
                    SzL = ncon({SzL,w{iteration,1},VMDH,conj(w{iteration,1}),conj(VMDH)},prop4_1_order);
                else %chi_inc(iteration) == 1
                    SzL = ncon({SzL,w{iteration,1},conj(w{iteration,1})},prop4_1_inc_order);
                end
                
                %remove two sites
                if Jmaxpos == Lcur
                    Si = PBC_pos(Jmaxpos - 5,Lcur-2);
                else
                    Si = PBC_pos(Jmaxpos - 4,Lcur-2);
                end
            end
            
        elseif Si == PBC_pos(Jmaxpos - 3,Lcur)
            %propagate 4 (2)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_2_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop4_2_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 4,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 3,Lcur-2);
            end
            
        elseif Si == PBC_pos(Jmaxpos - 2,Lcur)
            %propagate 4 (3)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_3_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop4_3_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 3,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            end
            
            %now a three-site operator
            combined = 3;
            
        elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
            %propagate 4 (4)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_4_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop4_4_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
            %now a two-site operator
            combined = 2;
            
        elseif Si == PBC_pos(Jmaxpos,Lcur)
            %propagate 4 (5)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_5_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop4_5_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
            %now a three-site operator
            combined = 3;
            
        elseif Si == PBC_pos(Jmaxpos + 1,Lcur)
            %propagate 4 (6)
            if chi_inc(iteration) == 0
                SzL = ncon({w{iteration,1},VMDH,w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(VMDH),conj(w{iteration,2})},prop4_6_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,1},w{iteration,2},u{iteration,1},SzL,...
                    conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2})},prop4_6_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 2,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            end
            
        elseif Si == PBC_pos(Jmaxpos + 2,Lcur)
            %propagate 4 (7)
            if chi_inc(iteration) == 0
                SzL = ncon({VMDH,w{iteration,2},SzL,conj(w{iteration,2}),conj(VMDH)},prop4_7_order);
            else %chi_inc(iteration) == 1
                SzL = ncon({w{iteration,2},SzL,conj(w{iteration,2})},prop4_7_inc_order);
            end
            
            %remove two sites
            if Jmaxpos == Lcur
                Si = PBC_pos(Jmaxpos - 1,Lcur-2);
            else
                Si = PBC_pos(Jmaxpos,Lcur-2);
            end
            
        else
            %no update
            if Jmaxpos < Si
                %two sites removed from the left of both sites
                Si = Si - 2;
            elseif Jmaxpos == Lcur
                %remove one site from the left one from the right
                Si = Si - 1;
                
                %to the right of both sites => no action
            end
        end
    end
end

%top
iteration = (L/2)-1;
Jmaxpos = Jmaxpos_vec(iteration);
Lcur = 4;

%check combined
if combined == 0
    %%% not combined %%%
    
    %check left and right are correct
    if PBC_pos(Sj-Jmaxpos+2,Lcur) < PBC_pos(Si-Jmaxpos+2,Lcur)
        %swap L and R
        temp = Sj;
        Sj = Si;
        Si = temp;
        temp = SzR;
        SzR = SzL;
        SzL = temp;
    end
    
    if Si == PBC_pos(Jmaxpos-1,Lcur) && Sj == PBC_pos(Jmaxpos+1,Lcur)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,SzR,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},corr_PBC1_at_order);
        
    elseif Si == PBC_pos(Jmaxpos,Lcur) && Sj == PBC_pos(Jmaxpos+2,Lcur)    
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,SzR,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},corr_PBC2_at_order);
    end

elseif combined == 2
    %%% combined, 2 site %%%
    if Si == PBC_pos(Jmaxpos - 2,Lcur)
        %PBC term        
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration+1,1},...
            SzL,conj(u{iteration+1,1}),conj(w{iteration,1}),conj(w{iteration,2}),...
            conj(VMDH),conj(VMDH)},h_PBC1_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
        %diagram 2: left
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},h_PBC2_at_order);
        
    elseif Si == Jmaxpos
        %diagram 3: centre
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            SzL,conj(u{iteration,1}),conj(w{iteration,1}),conj(w{iteration,2}),...
            conj(VMDH),conj(VMDH)},h_PBC3_at_order);
                
    elseif Si == PBC_pos(Jmaxpos + 1,Lcur)
        %diagram 4: right
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},h_PBC4_at_order);
    end
    
elseif combined == 3
    %%% combined, 3 site %%%
    if Si == PBC_pos(Jmaxpos - 3,Lcur)
        %PBC term (1)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop3_PBC1_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 2,Lcur)
        %PBC term (2)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop3_PBC2_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
        %propagate 3 (3)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop3_PBC3_at_order);
        
    elseif Si == Jmaxpos
        %propagate 3 (4)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop3_PBC4_at_order);
    end
        
else %combined == 4
    %%% combined, 4 site %%%
    if Si == PBC_pos(Jmaxpos,Lcur)
        %PBC term (1)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop4_PBC1_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 3,Lcur)
        %PBC term (2)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop4_PBC2_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 2,Lcur)
        %PBC term (3)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop4_PBC3_at_order);
        
    elseif Si == PBC_pos(Jmaxpos - 1,Lcur)
        %propagate 4 (4)
        corr = ncon({VMDH,VMDH,w{iteration,1},w{iteration,2},u{iteration,1},...
            u{iteration+1,1},SzL,conj(u{iteration,1}),conj(u{iteration+1,1}),...
            conj(w{iteration,1}),conj(w{iteration,2}),conj(VMDH),conj(VMDH)},prop4_PBC4_at_order);
    end
end
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%find optimal contraction orders
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% h_1_netcon(netcon({[-3,3,1,4],[1,2],[-1,-2,3,5],[-4,5,6,4],[6,2]},0,2,1,1)) = 1:6;
% h_1_order = {[-3,h_1_netcon(3),h_1_netcon(1),h_1_netcon(4)],...
%     [h_1_netcon(1),h_1_netcon(2)],...
%     [-1,-2,h_1_netcon(3),h_1_netcon(5)],...
%     [-4,h_1_netcon(5),h_1_netcon(6),h_1_netcon(4)],...
%     [h_1_netcon(6),h_1_netcon(2)]};
%
% h_2_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10],[11,10,12,8],[-2,9,13,11],[13,14],[14,12,-4,6]},0,2,1,1)) = 1:14;
% h_2_order = {[-1,h_2_netcon(3),h_2_netcon(1),h_2_netcon(4)],...
%     [h_2_netcon(1),h_2_netcon(2)],...
%     [h_2_netcon(2),h_2_netcon(5),-3,h_2_netcon(6)],...
%     [h_2_netcon(4),h_2_netcon(7),h_2_netcon(5),h_2_netcon(8)],...
%     [h_2_netcon(3),h_2_netcon(9),h_2_netcon(7),h_2_netcon(10)],...
%     [h_2_netcon(11),h_2_netcon(10),h_2_netcon(12),h_2_netcon(8)],...
%     [-2,h_2_netcon(9),h_2_netcon(13),h_2_netcon(11)],...
%     [h_2_netcon(13),h_2_netcon(14)],...
%     [h_2_netcon(14),h_2_netcon(12),-4,h_2_netcon(6)]};
%
% h_3_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[7,9,8,10],[11,9,12,10],[-2,3,13,11],[13,14],[14,12,-4,6]},0,2,1,1)) = 1:14;
% h_3_order = {[-1,h_3_netcon(3),h_3_netcon(1),h_3_netcon(4)],...
%     [h_3_netcon(1),h_3_netcon(2)],...
%     [h_3_netcon(2),h_3_netcon(5),-3,h_3_netcon(6)],...
%     [h_3_netcon(4),h_3_netcon(7),h_3_netcon(5),h_3_netcon(8)],...
%     [h_3_netcon(7),h_3_netcon(9),h_3_netcon(8),h_3_netcon(10)],...
%     [h_3_netcon(11),h_3_netcon(9),h_3_netcon(12),h_3_netcon(10)],...
%     [-2,h_3_netcon(3),h_3_netcon(13),h_3_netcon(11)],...
%     [h_3_netcon(13),h_3_netcon(14)],...
%     [h_3_netcon(14),h_3_netcon(12),-4,h_3_netcon(6)]};
%
% h_4_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[8,9,6,10],[11,7,12,9],[-2,3,13,11],[13,14],[14,12,-4,10]},0,2,1,1)) = 1:14;
% h_4_order = {[-1,h_4_netcon(3),h_4_netcon(1),h_4_netcon(4)],...
%     [h_4_netcon(1),h_4_netcon(2)],...
%     [h_4_netcon(2),h_4_netcon(5),-3,h_4_netcon(6)],...
%     [h_4_netcon(4),h_4_netcon(7),h_4_netcon(5),h_4_netcon(8)],...
%     [h_4_netcon(8),h_4_netcon(9),h_4_netcon(6),h_4_netcon(10)],...
%     [h_4_netcon(11),h_4_netcon(7),h_4_netcon(12),h_4_netcon(9)],...
%     [-2,h_4_netcon(3),h_4_netcon(13),h_4_netcon(11)],...
%     [h_4_netcon(13),h_4_netcon(14)],...
%     [h_4_netcon(14),h_4_netcon(12),-4,h_4_netcon(10)]};
%
% h_5_netcon(netcon({[1,2],[2,3,-1,4],[4,5,-3,-4],[6,3,-2,5],[1,6]},0,2,1,1)) = 1:6;
% h_5_order = {[h_5_netcon(1),h_5_netcon(2)],...
%     [h_5_netcon(2),h_5_netcon(3),-1,h_5_netcon(4)],...
%     [h_5_netcon(4),h_5_netcon(5),-3,-4],...
%     [h_5_netcon(6),h_5_netcon(3),-2,h_5_netcon(5)],...
%     [h_5_netcon(1),h_5_netcon(6)]};
% 
% corr_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10],[8,11,6,12],[13,10,14,11],[-2,9,15,13],[15,16],[16,14,-4,12]},0,2,1,1)) = 1:16;
% corr_order = {[-1,corr_netcon(3),corr_netcon(1),corr_netcon(4)],...
%     [corr_netcon(1),corr_netcon(2)],...
%     [corr_netcon(2),corr_netcon(5),-3,corr_netcon(6)],...
%     [corr_netcon(4),corr_netcon(7),corr_netcon(5),corr_netcon(8)],...
%     [corr_netcon(3),corr_netcon(9),corr_netcon(7),corr_netcon(10)],...
%     [corr_netcon(8),corr_netcon(11),corr_netcon(6),corr_netcon(12)],...
%     [corr_netcon(13),corr_netcon(10),corr_netcon(14),corr_netcon(11)],...
%     [-2,corr_netcon(9),corr_netcon(15),corr_netcon(13)],...
%     [corr_netcon(15),corr_netcon(16)],...
%     [corr_netcon(16),corr_netcon(14),-4,corr_netcon(12)]};
%
% make3_1_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[4,7,5,8],[-1,-2,3,9],[7,10,8,11],[12,10,13,11],[-4,9,14,12],[14,15],[15,13,-6,6]},0,2,1,1)) = 1:15;
% make3_1_order = {[-3,make3_1_netcon(3),make3_1_netcon(1),make3_1_netcon(4)],...
%     [make3_1_netcon(1),make3_1_netcon(2)],...
%     [make3_1_netcon(2),make3_1_netcon(5),-5,make3_1_netcon(6)],...
%     [make3_1_netcon(4),make3_1_netcon(7),make3_1_netcon(5),make3_1_netcon(8)],...
%     [-1,-2,make3_1_netcon(3),make3_1_netcon(9)],...
%     [make3_1_netcon(7),make3_1_netcon(10),make3_1_netcon(8),make3_1_netcon(11)],...
%     [make3_1_netcon(12),make3_1_netcon(10),make3_1_netcon(13),make3_1_netcon(11)],...
%     [-4,make3_1_netcon(9),make3_1_netcon(14),make3_1_netcon(12)],...
%     [make3_1_netcon(14),make3_1_netcon(15)],...
%     [make3_1_netcon(15),make3_1_netcon(13),-6,make3_1_netcon(6)]};
%
% make3_2_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[4,7,5,8],[-1,-2,3,9],[8,10,6,11],[12,7,13,10],[-4,9,14,12],[14,15],[15,13,-6,11]},0,2,1,1)) = 1:15;
% make3_2_order = {[-3,make3_2_netcon(3),make3_2_netcon(1),make3_2_netcon(4)],...
%     [make3_2_netcon(1),make3_2_netcon(2)],...
%     [make3_2_netcon(2),make3_2_netcon(5),-5,make3_2_netcon(6)],...
%     [make3_2_netcon(4),make3_2_netcon(7),make3_2_netcon(5),make3_2_netcon(8)],...
%     [-1,-2,make3_2_netcon(3),make3_2_netcon(9)],...
%     [make3_2_netcon(8),make3_2_netcon(10),make3_2_netcon(6),make3_2_netcon(11)],...
%     [make3_2_netcon(12),make3_2_netcon(7),make3_2_netcon(13),make3_2_netcon(10)],...
%     [-4,make3_2_netcon(9),make3_2_netcon(14),make3_2_netcon(12)],...
%     [make3_2_netcon(14),make3_2_netcon(15)],...
%     [make3_2_netcon(15),make3_2_netcon(13),-6,make3_2_netcon(11)]};
%
% make3_3_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10],[6,11,-5,-6],[12,10,13,8],[-2,9,14,12],[14,15],[15,13,-4,11]},0,2,1,1)) = 1:15;
% make3_3_order = {[-1,make3_3_netcon(3),make3_3_netcon(1),make3_3_netcon(4)],...
%     [make3_3_netcon(1),make3_3_netcon(2)],...
%     [make3_3_netcon(2),make3_3_netcon(5),-3,make3_3_netcon(6)],...
%     [make3_3_netcon(4),make3_3_netcon(7),make3_3_netcon(5),make3_3_netcon(8)],...
%     [make3_3_netcon(3),make3_3_netcon(9),make3_3_netcon(7),make3_3_netcon(10)],...
%     [make3_3_netcon(6),make3_3_netcon(11),-5,-6],...
%     [make3_3_netcon(12),make3_3_netcon(10),make3_3_netcon(13),make3_3_netcon(8)],...
%     [-2,make3_3_netcon(9),make3_3_netcon(14),make3_3_netcon(12)],...
%     [make3_3_netcon(14),make3_3_netcon(15)],...
%     [make3_3_netcon(15),make3_3_netcon(13),-4,make3_3_netcon(11)]};
%
% make3_4_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[7,9,8,10],[6,11,-5,-6],[12,9,13,10],[-2,3,14,12],[14,15],[15,13,-4,11]},0,2,1,1)) = 1:15;
% make3_4_order = {[-1,make3_4_netcon(3),make3_4_netcon(1),make3_4_netcon(4)],...
%     [make3_4_netcon(1),make3_4_netcon(2)],...
%     [make3_4_netcon(2),make3_4_netcon(5),-3,make3_4_netcon(6)],...
%     [make3_4_netcon(4),make3_4_netcon(7),make3_4_netcon(5),make3_4_netcon(8)],...
%     [make3_4_netcon(7),make3_4_netcon(9),make3_4_netcon(8),make3_4_netcon(10)],...
%     [make3_4_netcon(6),make3_4_netcon(11),-5,-6],...
%     [make3_4_netcon(12),make3_4_netcon(9),make3_4_netcon(13),make3_4_netcon(10)],...
%     [-2,make3_4_netcon(3),make3_4_netcon(14),make3_4_netcon(12)],...
%     [make3_4_netcon(14),make3_4_netcon(15)],...
%     [make3_4_netcon(15),make3_4_netcon(13),-4,make3_4_netcon(11)]};
%
% prop3_1_netcon(netcon({[-1,-2,-3,-4,3,5],[-5,3,1,4],[1,2],[-6,5,6,4],[6,2]},0,2,1,1)) = 1:6;
% prop3_1_order = {[-1,-2,-3,-4,prop3_1_netcon(3),prop3_1_netcon(5)],...
%     [-5,prop3_1_netcon(3),prop3_1_netcon(1),prop3_1_netcon(4)],...
%     [prop3_1_netcon(1),prop3_1_netcon(2)],...
%     [-6,prop3_1_netcon(5),prop3_1_netcon(6),prop3_1_netcon(4)],...
%     [prop3_1_netcon(6),prop3_1_netcon(2)]};
%
% prop3_2_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[4,7,5,8],[-1,-2,3,9,7,10],[11,10,12,8],[-4,9,13,11],[13,14],[14,12,-6,6]},0,2,1,1)) = 1:14;
% prop3_2_order = {[-3,prop3_2_netcon(3),prop3_2_netcon(1),prop3_2_netcon(4)],...
%     [prop3_2_netcon(1),prop3_2_netcon(2)],...
%     [prop3_2_netcon(2),prop3_2_netcon(5),-5,prop3_2_netcon(6)],...
%     [prop3_2_netcon(4),prop3_2_netcon(7),prop3_2_netcon(5),prop3_2_netcon(8)],...
%     [-1,-2,prop3_2_netcon(3),prop3_2_netcon(9),prop3_2_netcon(7),prop3_2_netcon(10)],...
%     [prop3_2_netcon(11),prop3_2_netcon(10),prop3_2_netcon(12),prop3_2_netcon(8)],...
%     [-4,prop3_2_netcon(9),prop3_2_netcon(13),prop3_2_netcon(11)],...
%     [prop3_2_netcon(13),prop3_2_netcon(14)],...
%     [prop3_2_netcon(14),prop3_2_netcon(12),-6,prop3_2_netcon(6)]};
%
% prop3_3_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10,8,11],[12,10,13,11],[-2,9,14,12],[14,15],[15,13,-4,6]},0,2,1,1)) = 1:15;
% prop3_3_order = {[-1,prop3_3_netcon(3),prop3_3_netcon(1),prop3_3_netcon(4)],...
%     [prop3_3_netcon(1),prop3_3_netcon(2)],...
%     [prop3_3_netcon(2),prop3_3_netcon(5),-3,prop3_3_netcon(6)],...
%     [prop3_3_netcon(4),prop3_3_netcon(7),prop3_3_netcon(5),prop3_3_netcon(8)],...
%     [prop3_3_netcon(3),prop3_3_netcon(9),prop3_3_netcon(7),prop3_3_netcon(10),prop3_3_netcon(8),prop3_3_netcon(11)],...
%     [prop3_3_netcon(12),prop3_3_netcon(10),prop3_3_netcon(13),prop3_3_netcon(11)],...
%     [-2,prop3_3_netcon(9),prop3_3_netcon(14),prop3_3_netcon(12)],...
%     [prop3_3_netcon(14),prop3_3_netcon(15)],...
%     [prop3_3_netcon(15),prop3_3_netcon(13),-4,prop3_3_netcon(6)]};
%
% prop3_4_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[7,9,8,10,6,11],[12,9,13,10],[-2,3,14,12],[14,15],[15,13,-4,11]},0,2,1,1)) = 1:15;
% prop3_4_order = {[-1,prop3_4_netcon(3),prop3_4_netcon(1),prop3_4_netcon(4)],...
%     [prop3_4_netcon(1),prop3_4_netcon(2)],...
%     [prop3_4_netcon(2),prop3_4_netcon(5),-3,prop3_4_netcon(6)],...
%     [prop3_4_netcon(4),prop3_4_netcon(7),prop3_4_netcon(5),prop3_4_netcon(8)],...
%     [prop3_4_netcon(7),prop3_4_netcon(9),prop3_4_netcon(8),prop3_4_netcon(10),prop3_4_netcon(6),prop3_4_netcon(11)],...
%     [prop3_4_netcon(12),prop3_4_netcon(9),prop3_4_netcon(13),prop3_4_netcon(10)],...
%     [-2,prop3_4_netcon(3),prop3_4_netcon(14),prop3_4_netcon(12)],...
%     [prop3_4_netcon(14),prop3_4_netcon(15)],...
%     [prop3_4_netcon(15),prop3_4_netcon(13),-4,prop3_4_netcon(11)]};
%
% prop3_5_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[8,9,6,10,-5,-6],[11,7,12,9],[-2,3,13,11],[13,14],[14,12,-4,10]},0,2,1,1)) = 1:14;
% prop3_5_order = {[-1,prop3_5_netcon(3),prop3_5_netcon(1),prop3_5_netcon(4)],...
%     [prop3_5_netcon(1),prop3_5_netcon(2)],...
%     [prop3_5_netcon(2),prop3_5_netcon(5),-3,prop3_5_netcon(6)],...
%     [prop3_5_netcon(4),prop3_5_netcon(7),prop3_5_netcon(5),prop3_5_netcon(8)],...
%     [prop3_5_netcon(8),prop3_5_netcon(9),prop3_5_netcon(6),prop3_5_netcon(10),-5,-6],...
%     [prop3_5_netcon(11),prop3_5_netcon(7),prop3_5_netcon(12),prop3_5_netcon(9)],...
%     [-2,prop3_5_netcon(3),prop3_5_netcon(13),prop3_5_netcon(11)],...
%     [prop3_5_netcon(13),prop3_5_netcon(14)],...
%     [prop3_5_netcon(14),prop3_5_netcon(12),-4,prop3_5_netcon(10)]};
%
% prop3_6_netcon(netcon({[1,2],[2,3,-1,4],[4,5,-3,-4,-5,-6],[6,3,-2,5],[1,6]},0,2,1,1)) = 1:6;
% prop3_6_order = {[prop3_6_netcon(1),prop3_6_netcon(2)],...
%     [prop3_6_netcon(2),prop3_6_netcon(3),-1,prop3_6_netcon(4)],...
%     [prop3_6_netcon(4),prop3_6_netcon(5),-3,-4,-5,-6],...
%     [prop3_6_netcon(6),prop3_6_netcon(3),-2,prop3_6_netcon(5)],...
%     [prop3_6_netcon(1),prop3_6_netcon(6)]};
%
% make4_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[-1,-2,3,7],[6,8,-7,-8],[-4,7,9,4],[9,10],[10,5,-6,8]},0,2,1,1)) = 1:10;
% make4_order = {[-3,make4_netcon(3),make4_netcon(1),make4_netcon(4)],...
%     [make4_netcon(1),make4_netcon(2)],...
%     [make4_netcon(2),make4_netcon(5),-5,make4_netcon(6)],...
%     [-1,-2,make4_netcon(3),make4_netcon(7)],...
%     [make4_netcon(6),make4_netcon(8),-7,-8],...
%     [-4,make4_netcon(7),make4_netcon(9),make4_netcon(4)],...
%     [make4_netcon(9),make4_netcon(10)],...
%     [make4_netcon(10),make4_netcon(5),-6,make4_netcon(8)]};
%
% prop4_1_netcon(netcon({[-1,-2,-3,-4,-5,-6,3,5],[-7,3,1,4],[1,2],[-8,5,6,4],[6,2]},0,2,1,1)) = 1:6;
% prop4_1_order = {[-1,-2,-3,-4,-5,-6,prop4_1_netcon(3),prop4_1_netcon(5)],...
%     [-7,prop4_1_netcon(3),prop4_1_netcon(1),prop4_1_netcon(4)],...
%     [prop4_1_netcon(1),prop4_1_netcon(2)],...
%     [-8,prop4_1_netcon(5),prop4_1_netcon(6),prop4_1_netcon(4)],...
%     [prop4_1_netcon(6),prop4_1_netcon(2)]};
%
% prop4_2_netcon(netcon({[-5,3,1,4],[1,2],[2,5,-7,6],[4,7,5,8],[-1,-2,-3,-4,3,9,7,10],[11,10,12,8],[-6,9,13,11],[13,14],[14,12,-8,6]},0,2,1,1)) = 1:14;
% prop4_2_order = {[-5,prop4_2_netcon(3),prop4_2_netcon(1),prop4_2_netcon(4)],...
%     [prop4_2_netcon(1),prop4_2_netcon(2)],...
%     [prop4_2_netcon(2),prop4_2_netcon(5),-7,prop4_2_netcon(6)],...
%     [prop4_2_netcon(4),prop4_2_netcon(7),prop4_2_netcon(5),prop4_2_netcon(8)],...
%     [-1,-2,-3,-4,prop4_2_netcon(3),prop4_2_netcon(9),prop4_2_netcon(7),prop4_2_netcon(10)],...
%     [prop4_2_netcon(11),prop4_2_netcon(10),prop4_2_netcon(12),prop4_2_netcon(8)],...
%     [-6,prop4_2_netcon(9),prop4_2_netcon(13),prop4_2_netcon(11)],...
%     [prop4_2_netcon(13),prop4_2_netcon(14)],...
%     [prop4_2_netcon(14),prop4_2_netcon(12),-8,prop4_2_netcon(6)]};
%
% prop4_3_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[4,7,5,8],[-1,-2,3,9,7,10,8,11],[12,10,13,11],[-4,9,14,12],[14,15],[15,13,-6,6]},0,2,1,1)) = 1:15;
% prop4_3_order = {[-3,prop4_3_netcon(3),prop4_3_netcon(1),prop4_3_netcon(4)],...
%     [prop4_3_netcon(1),prop4_3_netcon(2)],...
%     [prop4_3_netcon(2),prop4_3_netcon(5),-5,prop4_3_netcon(6)],...
%     [prop4_3_netcon(4),prop4_3_netcon(7),prop4_3_netcon(5),prop4_3_netcon(8)],...
%     [-1,-2,prop4_3_netcon(3),prop4_3_netcon(9),prop4_3_netcon(7),prop4_3_netcon(10),prop4_3_netcon(8),prop4_3_netcon(11)],...
%     [prop4_3_netcon(12),prop4_3_netcon(10),prop4_3_netcon(13),prop4_3_netcon(11)],...
%     [-4,prop4_3_netcon(9),prop4_3_netcon(14),prop4_3_netcon(12)],...
%     [prop4_3_netcon(14),prop4_3_netcon(15)],...
%     [prop4_3_netcon(15),prop4_3_netcon(13),-6,prop4_3_netcon(6)]};
%
% prop4_4_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10,8,11,6,12],[13,10,14,11],[-2,9,15,13],[15,16],[16,14,-4,12]},0,2,1,1)) = 1:16;
% prop4_4_order = {[-1,prop4_4_netcon(3),prop4_4_netcon(1),prop4_4_netcon(4)],...
%     [prop4_4_netcon(1),prop4_4_netcon(2)],...
%     [prop4_4_netcon(2),prop4_4_netcon(5),-3,prop4_4_netcon(6)],...
%     [prop4_4_netcon(4),prop4_4_netcon(7),prop4_4_netcon(5),prop4_4_netcon(8)],...
%     [prop4_4_netcon(3),prop4_4_netcon(9),prop4_4_netcon(7),prop4_4_netcon(10),prop4_4_netcon(8),prop4_4_netcon(11),prop4_4_netcon(6),prop4_4_netcon(12)],...
%     [prop4_4_netcon(13),prop4_4_netcon(10),prop4_4_netcon(14),prop4_4_netcon(11)],...
%     [-2,prop4_4_netcon(9),prop4_4_netcon(15),prop4_4_netcon(13)],...
%     [prop4_4_netcon(15),prop4_4_netcon(16)],...
%     [prop4_4_netcon(16),prop4_4_netcon(14),-4,prop4_4_netcon(12)]};
%
% prop4_5_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[7,9,8,10,6,11,-5,-6],[12,9,13,10],[-2,3,14,12],[14,15],[15,13,-4,11]},0,2,1,1)) = 1:15;
% prop4_5_order = {[-1,prop4_5_netcon(3),prop4_5_netcon(1),prop4_5_netcon(4)],...
%     [prop4_5_netcon(1),prop4_5_netcon(2)],...
%     [prop4_5_netcon(2),prop4_5_netcon(5),-3,prop4_5_netcon(6)],...
%     [prop4_5_netcon(4),prop4_5_netcon(7),prop4_5_netcon(5),prop4_5_netcon(8)],...
%     [prop4_5_netcon(7),prop4_5_netcon(9),prop4_5_netcon(8),prop4_5_netcon(10),prop4_5_netcon(6),prop4_5_netcon(11),-5,-6],...
%     [prop4_5_netcon(12),prop4_5_netcon(9),prop4_5_netcon(13),prop4_5_netcon(10)],...
%     [-2,prop4_5_netcon(3),prop4_5_netcon(14),prop4_5_netcon(12)],...
%     [prop4_5_netcon(14),prop4_5_netcon(15)],...
%     [prop4_5_netcon(15),prop4_5_netcon(13),-4,prop4_5_netcon(11)]};
%
% prop4_6_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[8,9,6,10,-5,-6,-7,-8],[11,7,12,9],[-2,3,13,11],[13,14],[14,12,-4,10]},0,2,1,1)) =  1:14;
% prop4_6_order = {[-1,prop4_6_netcon(3),prop4_6_netcon(1),prop4_6_netcon(4)],...
%     [prop4_6_netcon(1),prop4_6_netcon(2)],...
%     [prop4_6_netcon(2),prop4_6_netcon(5),-3,prop4_6_netcon(6)],...
%     [prop4_6_netcon(4),prop4_6_netcon(7),prop4_6_netcon(5),prop4_6_netcon(8)],...
%     [prop4_6_netcon(8),prop4_6_netcon(9),prop4_6_netcon(6),prop4_6_netcon(10),-5,-6,-7,-8],...
%     [prop4_6_netcon(11),prop4_6_netcon(7),prop4_6_netcon(12),prop4_6_netcon(9)],...
%     [-2,prop4_6_netcon(3),prop4_6_netcon(13),prop4_6_netcon(11)],...
%     [prop4_6_netcon(13),prop4_6_netcon(14)],...
%     [prop4_6_netcon(14),prop4_6_netcon(12),-4,prop4_6_netcon(10)]};
%
% prop4_7_netcon(netcon({[1,2],[2,3,-1,4],[4,5,-3,-4,-5,-6,-7,-8],[6,3,-2,5],[1,6]},0,2,1,1)) = 1:6;
% prop4_7_order = {[prop4_7_netcon(1),prop4_7_netcon(2)],...
%     [prop4_7_netcon(2),prop4_7_netcon(3),-1,prop4_7_netcon(4)],...
%     [prop4_7_netcon(4),prop4_7_netcon(5),-3,-4,-5,-6,-7,-8],...
%     [prop4_7_netcon(6),prop4_7_netcon(3),-2,prop4_7_netcon(5)],...
%     [prop4_7_netcon(1),prop4_7_netcon(6)]};
%
% prop4_PBC6_netcon(netcon({[-3,3,1,4],[1,2],[2,5,-5,6],[6,8,-7,-8,-1,-2,3,7],[-4,7,9,4],[9,10],[10,5,-6,8]},0,2,1,1)) = 1:10;
% prop4_PBC6_order = {[-3,prop4_PBC6_netcon(3),prop4_PBC6_netcon(1),prop4_PBC6_netcon(4)],...
%     [prop4_PBC6_netcon(1),prop4_PBC6_netcon(2)],...
%     [prop4_PBC6_netcon(2),prop4_PBC6_netcon(5),-5,prop4_PBC6_netcon(6)],...
%     [prop4_PBC6_netcon(6),prop4_PBC6_netcon(8),-7,-8,-1,-2,prop4_PBC6_netcon(3),prop4_PBC6_netcon(7)],...
%     [-4,prop4_PBC6_netcon(7),prop4_PBC6_netcon(9),prop4_PBC6_netcon(4)],...
%     [prop4_PBC6_netcon(9),prop4_PBC6_netcon(10)],...
%     [prop4_PBC6_netcon(10),prop4_PBC6_netcon(5),-6,prop4_PBC6_netcon(8)]};
%
% h_1_inc_netcon(netcon({[-3,1,2],[-1,-2,1,3],[-4,3,2]},0,2,1,1)) = 1:3;
% h_1_inc_order = {[-3,h_1_inc_netcon(1),h_1_inc_netcon(2)],...
%     [-1,-2,h_1_inc_netcon(1),h_1_inc_netcon(3)],...
%     [-4,h_1_inc_netcon(3),h_1_inc_netcon(2)]};
%
% h_2_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[1,7,5,8],[9,8,10,6],[-2,7,9],[-4,10,4]},0,2,1,1)) = 1:10;
% h_2_inc_order = {[-1,h_2_inc_netcon(1),h_2_inc_netcon(2)],...
%     [-3,h_2_inc_netcon(3),h_2_inc_netcon(4)],...
%     [h_2_inc_netcon(2),h_2_inc_netcon(5),h_2_inc_netcon(3),h_2_inc_netcon(6)],...
%     [h_2_inc_netcon(1),h_2_inc_netcon(7),h_2_inc_netcon(5),h_2_inc_netcon(8)],...
%     [h_2_inc_netcon(9),h_2_inc_netcon(8),h_2_inc_netcon(10),h_2_inc_netcon(6)],...
%     [-2,h_2_inc_netcon(7),h_2_inc_netcon(9)],...
%     [-4,h_2_inc_netcon(10),h_2_inc_netcon(4)]};
%
% h_3_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[5,7,6,8],[9,7,10,8],[-2,1,9],[-4,10,4]},0,2,1,1)) = 1:10;
% h_3_inc_order = {[-1,h_3_inc_netcon(1),h_3_inc_netcon(2)],...
%     [-3,h_3_inc_netcon(3),h_3_inc_netcon(4)],...
%     [h_3_inc_netcon(2),h_3_inc_netcon(5),h_3_inc_netcon(3),h_3_inc_netcon(6)],...
%     [h_3_inc_netcon(5),h_3_inc_netcon(7),h_3_inc_netcon(6),h_3_inc_netcon(8)],...
%     [h_3_inc_netcon(9),h_3_inc_netcon(7),h_3_inc_netcon(10),h_3_inc_netcon(8)],...
%     [-2,h_3_inc_netcon(1),h_3_inc_netcon(9)],[-4,h_3_inc_netcon(10),h_3_inc_netcon(4)]}
%
% h_4_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[6,7,4,8],[9,5,10,7],[-2,1,9],[-4,10,8]},0,2,1,1)) = 1:10;
% h_4_inc_order = {[-1,h_4_inc_netcon(1),h_4_inc_netcon(2)],...
%     [-3,h_4_inc_netcon(3),h_4_inc_netcon(4)],...
%     [h_4_inc_netcon(2),h_4_inc_netcon(5),h_4_inc_netcon(3),h_4_inc_netcon(6)],...
%     [h_4_inc_netcon(6),h_4_inc_netcon(7),h_4_inc_netcon(4),h_4_inc_netcon(8)],...
%     [h_4_inc_netcon(9),h_4_inc_netcon(5),h_4_inc_netcon(10),h_4_inc_netcon(7)],...
%     [-2,h_4_inc_netcon(1),h_4_inc_netcon(9)],[-4,h_4_inc_netcon(10),h_4_inc_netcon(8)]};
%
% h_5_inc_netcon(netcon({[-1,1,2],[2,3,-3,-4],[-2,1,3]},0,2,1,1)) = 1:3;
% h_5_inc_order = {[-1,h_5_inc_netcon(1),h_5_inc_netcon(2)],...
%     [h_5_inc_netcon(2),h_5_inc_netcon(3),-3,-4],...
%     [-2,h_5_inc_netcon(1),h_5_inc_netcon(3)]};
%
% corr_inc_netcon(netcon({[-1,3,1,4],[1,2],[2,5,-3,6],[4,7,5,8],[3,9,7,10],[8,11,6,12],[13,10,14,11],[-2,9,15,13],[15,16],[16,14,-4,12]},0,2,1,1)) = 1:16;
% corr_inc_order = {[-1,corr_inc_netcon(3),corr_inc_netcon(1),corr_inc_netcon(4)],...
%     [corr_inc_netcon(1),corr_inc_netcon(2)],...
%     [corr_inc_netcon(2),corr_inc_netcon(5),-3,corr_inc_netcon(6)],...
%     [corr_inc_netcon(4),corr_inc_netcon(7),corr_inc_netcon(5),corr_inc_netcon(8)],...
%     [corr_inc_netcon(3),corr_inc_netcon(9),corr_inc_netcon(7),corr_inc_netcon(10)],...
%     [corr_inc_netcon(8),corr_inc_netcon(11),corr_inc_netcon(6),corr_inc_netcon(12)],...
%     [corr_inc_netcon(13),corr_inc_netcon(10),corr_inc_netcon(14),corr_inc_netcon(11)],...
%     [-2,corr_inc_netcon(9),corr_inc_netcon(15),corr_inc_netcon(13)],...
%     [corr_inc_netcon(15),corr_inc_netcon(16)],...
%     [corr_inc_netcon(16),corr_inc_netcon(14),-4,corr_inc_netcon(12)]};
% 
% make3_1_inc_netcon(netcon({[-3,1,2],[-5,3,4],[2,5,3,6],[-1,-2,1,7],[5,8,6,9],[10,8,11,9],[-4,7,10],[-6,11,4]},0,2,1,1)) = 1:11;
% make3_1_inc_order = {[-3,make3_1_inc_netcon(1),make3_1_inc_netcon(2)],...
%     [-5,make3_1_inc_netcon(3),make3_1_inc_netcon(4)],...
%     [make3_1_inc_netcon(2),make3_1_inc_netcon(5),make3_1_inc_netcon(3),make3_1_inc_netcon(6)],...
%     [-1,-2,make3_1_inc_netcon(1),make3_1_inc_netcon(7)],...
%     [make3_1_inc_netcon(5),make3_1_inc_netcon(8),make3_1_inc_netcon(6),make3_1_inc_netcon(9)],...
%     [make3_1_inc_netcon(10),make3_1_inc_netcon(8),make3_1_inc_netcon(11),make3_1_inc_netcon(9)],...
%     [-4,make3_1_inc_netcon(7),make3_1_inc_netcon(10)],...
%     [-6,make3_1_inc_netcon(11),make3_1_inc_netcon(4)]};
% 
% make3_2_inc_netcon(netcon({[-3,1,2],[-5,3,4],[2,5,3,6],[-1,-2,1,7],[6,8,4,9],[10,5,11,8],[-4,7,10],[-6,11,9]},0,2,1,1)) = 1:11;
% make3_2_inc_order = {[-3,make3_2_inc_netcon(1),make3_2_inc_netcon(2)],...
%     [-5,make3_2_inc_netcon(3),make3_2_inc_netcon(4)],...
%     [make3_2_inc_netcon(2),make3_2_inc_netcon(5),make3_2_inc_netcon(3),make3_2_inc_netcon(6)],...
%     [-1,-2,make3_2_inc_netcon(1),make3_2_inc_netcon(7)],...
%     [make3_2_inc_netcon(6),make3_2_inc_netcon(8),make3_2_inc_netcon(4),make3_2_inc_netcon(9)],...
%     [make3_2_inc_netcon(10),make3_2_inc_netcon(5),make3_2_inc_netcon(11),make3_2_inc_netcon(8)],...
%     [-4,make3_2_inc_netcon(7),make3_2_inc_netcon(10)],...
%     [-6,make3_2_inc_netcon(11),make3_2_inc_netcon(9)]};
% 
% make3_3_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[1,7,5,8],[4,9,-5,-6],[10,8,11,6],[-2,7,10],[-4,11,9]},0,2,1,1)) = 1:11;
% make3_3_inc_order = {[-1,make3_3_inc_netcon(1),make3_3_inc_netcon(2)],...
%     [-3,make3_3_inc_netcon(3),make3_3_inc_netcon(4)],...
%     [make3_3_inc_netcon(2),make3_3_inc_netcon(5),make3_3_inc_netcon(3),make3_3_inc_netcon(6)],...
%     [make3_3_inc_netcon(1),make3_3_inc_netcon(7),make3_3_inc_netcon(5),make3_3_inc_netcon(8)],...
%     [make3_3_inc_netcon(4),make3_3_inc_netcon(9),-5,-6],...
%     [make3_3_inc_netcon(10),make3_3_inc_netcon(8),make3_3_inc_netcon(11),make3_3_inc_netcon(6)],...
%     [-2,make3_3_inc_netcon(7),make3_3_inc_netcon(10)],...
%     [-4,make3_3_inc_netcon(11),make3_3_inc_netcon(9)]};
% 
% make3_4_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[5,7,6,8],[4,9,-5,-6],[10,7,11,8],[-2,1,10],[-4,11,9]},0,2,1,1)) = 1:11;
% make3_4_inc_order = {[-1,make3_4_inc_netcon(1),make3_4_inc_netcon(2)],...
%     [-3,make3_4_inc_netcon(3),make3_4_inc_netcon(4)],...
%     [make3_4_inc_netcon(2),make3_4_inc_netcon(5),make3_4_inc_netcon(3),make3_4_inc_netcon(6)],...
%     [make3_4_inc_netcon(5),make3_4_inc_netcon(7),make3_4_inc_netcon(6),make3_4_inc_netcon(8)],...
%     [make3_4_inc_netcon(4),make3_4_inc_netcon(9),-5,-6],...
%     [make3_4_inc_netcon(10),make3_4_inc_netcon(7),make3_4_inc_netcon(11),make3_4_inc_netcon(8)],...
%     [-2,make3_4_inc_netcon(1),make3_4_inc_netcon(10)],...
%     [-4,make3_4_inc_netcon(11),make3_4_inc_netcon(9)]};
% 
% prop3_1_inc_netcon(netcon({[-5,1,2],[-1,-2,-3,-4,1,3],[-6,3,2]},0,2,1,1)) = 1:3;
% prop3_1_inc_order = {[-5,prop3_1_inc_netcon(1),prop3_1_inc_netcon(2)],...
%     [-1,-2,-3,-4,prop3_1_inc_netcon(1),prop3_1_inc_netcon(3)],...
%     [-6,prop3_1_inc_netcon(3),prop3_1_inc_netcon(2)]};
% 
% prop3_2_inc_netcon(netcon({[-3,1,2],[-5,3,4],[2,5,3,6],[-1,-2,1,7,5,8],[9,8,10,6],[-4,7,9],[-6,10,4]},0,2,1,1)) = 1:10;
% prop3_2_inc_order = {[-3,prop3_2_inc_netcon(1),prop3_2_inc_netcon(2)],...
%     [-5,prop3_2_inc_netcon(3),prop3_2_inc_netcon(4)],...
%     [prop3_2_inc_netcon(2),prop3_2_inc_netcon(5),prop3_2_inc_netcon(3),prop3_2_inc_netcon(6)],...
%     [-1,-2,prop3_2_inc_netcon(1),prop3_2_inc_netcon(7),prop3_2_inc_netcon(5),prop3_2_inc_netcon(8)],...
%     [prop3_2_inc_netcon(9),prop3_2_inc_netcon(8),prop3_2_inc_netcon(10),prop3_2_inc_netcon(6)],...
%     [-4,prop3_2_inc_netcon(7),prop3_2_inc_netcon(9)],...
%     [-6,prop3_2_inc_netcon(10),prop3_2_inc_netcon(4)]};
% 
% prop3_3_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[1,7,5,8,6,9],[10,8,11,9],[-2,7,10],[-4,11,4]},0,2,1,1)) = 1:11;
% prop3_3_inc_order = {[-1,prop3_3_inc_netcon(1),prop3_3_inc_netcon(2)],...
%     [-3,prop3_3_inc_netcon(3),prop3_3_inc_netcon(4)],...
%     [prop3_3_inc_netcon(2),prop3_3_inc_netcon(5),prop3_3_inc_netcon(3),prop3_3_inc_netcon(6)],...
%     [prop3_3_inc_netcon(1),prop3_3_inc_netcon(7),prop3_3_inc_netcon(5),prop3_3_inc_netcon(8),prop3_3_inc_netcon(6),prop3_3_inc_netcon(9)],...
%     [prop3_3_inc_netcon(10),prop3_3_inc_netcon(8),prop3_3_inc_netcon(11),prop3_3_inc_netcon(9)],...
%     [-2,prop3_3_inc_netcon(7),prop3_3_inc_netcon(10)],...
%     [-4,prop3_3_inc_netcon(11),prop3_3_inc_netcon(4)]};
% 
% prop3_4_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[5,7,6,8,4,9],[10,7,11,8],[-2,1,10],[-4,11,9]},0,2,1,1)) = 1:11;
% prop3_4_inc_order = {[-1,prop3_4_inc_netcon(1),prop3_4_inc_netcon(2)],...
%     [-3,prop3_4_inc_netcon(3),prop3_4_inc_netcon(4)],...
%     [prop3_4_inc_netcon(2),prop3_4_inc_netcon(5),prop3_4_inc_netcon(3),prop3_4_inc_netcon(6)],...
%     [prop3_4_inc_netcon(5),prop3_4_inc_netcon(7),prop3_4_inc_netcon(6),prop3_4_inc_netcon(8),prop3_4_inc_netcon(4),prop3_4_inc_netcon(9)],...
%     [prop3_4_inc_netcon(10),prop3_4_inc_netcon(7),prop3_4_inc_netcon(11),prop3_4_inc_netcon(8)],...
%     [-2,prop3_4_inc_netcon(1),prop3_4_inc_netcon(10)],...
%     [-4,prop3_4_inc_netcon(11),prop3_4_inc_netcon(9)]};
% 
% prop3_5_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[6,7,4,8,-5,-6],[9,5,10,7],[-2,1,9],[-4,10,8]},0,2,1,1)) = 1:10;
% prop3_5_inc_order = {[-1,prop3_5_inc_netcon(1),prop3_5_inc_netcon(2)],...
%     [-3,prop3_5_inc_netcon(3),prop3_5_inc_netcon(4)],...
%     [prop3_5_inc_netcon(2),prop3_5_inc_netcon(5),prop3_5_inc_netcon(3),prop3_5_inc_netcon(6)],...
%     [prop3_5_inc_netcon(6),prop3_5_inc_netcon(7),prop3_5_inc_netcon(4),prop3_5_inc_netcon(8),-5,-6],...
%     [prop3_5_inc_netcon(9),prop3_5_inc_netcon(5),prop3_5_inc_netcon(10),prop3_5_inc_netcon(7)],...
%     [-2,prop3_5_inc_netcon(1),prop3_5_inc_netcon(9)],...
%     [-4,prop3_5_inc_netcon(10),prop3_5_inc_netcon(8)]};
% 
% prop3_6_inc_netcon(netcon({[-1,1,2],[2,3,-3,-4,-5,-6],[-2,1,3]},0,2,1,1)) = 1:3;
% prop3_6_inc_order = {[-1,prop3_6_inc_netcon(1),prop3_6_inc_netcon(2)],...
%     [prop3_6_inc_netcon(2),prop3_6_inc_netcon(3),-3,-4,-5,-6],...
%     [-2,prop3_6_inc_netcon(1),prop3_6_inc_netcon(3)]};
% 
% prop4_1_inc_netcon(netcon({[-1,-2,-3,-4,-5,-6,1,3],[-7,1,2],[-8,3,2]},0,2,1,1)) = 1:3;
% prop4_1_inc_order = {[-1,-2,-3,-4,-5,-6,prop4_1_inc_netcon(1),prop4_1_inc_netcon(3)],...
%     [-7,prop4_1_inc_netcon(1),prop4_1_inc_netcon(2)],...
%     [-8,prop4_1_inc_netcon(3),prop4_1_inc_netcon(2)]};
%
% prop4_2_inc_netcon(netcon({[-5,1,2],[-7,3,4],[2,5,3,6],[-1,-2,-3,-4,1,7,5,8],[9,8,10,6],[-6,7,9],[-8,10,4]},0,2,1,1)) = 1:10;
% prop4_2_inc_order = {[-5,prop4_2_inc_netcon(1),prop4_2_inc_netcon(2)],...
%     [-7,prop4_2_inc_netcon(3),prop4_2_inc_netcon(4)],...
%     [prop4_2_inc_netcon(2),prop4_2_inc_netcon(5),prop4_2_inc_netcon(3),prop4_2_inc_netcon(6)],...
%     [-1,-2,-3,-4,prop4_2_inc_netcon(1),prop4_2_inc_netcon(7),prop4_2_inc_netcon(5),prop4_2_inc_netcon(8)],...
%     [prop4_2_inc_netcon(9),prop4_2_inc_netcon(8),prop4_2_inc_netcon(10),prop4_2_inc_netcon(6)],...
%     [-6,prop4_2_inc_netcon(7),prop4_2_inc_netcon(9)],...
%     [-8,prop4_2_inc_netcon(10),prop4_2_inc_netcon(4)]};
%
% prop4_3_inc_netcon(netcon({[-3,1,2],[-5,3,4],[2,5,3,6],[-1,-2,1,7,5,8,6,9],[10,8,11,9],[-4,7,10],[-6,11,4]},0,2,1,1)) = 1:11;
% prop4_3_inc_order = {[-3,prop4_3_inc_netcon(1),prop4_3_inc_netcon(2)],...
%     [-5,prop4_3_inc_netcon(3),prop4_3_inc_netcon(4)],...
%     [prop4_3_inc_netcon(2),prop4_3_inc_netcon(5),prop4_3_inc_netcon(3),prop4_3_inc_netcon(6)],...
%     [-1,-2,prop4_3_inc_netcon(1),prop4_3_inc_netcon(7),prop4_3_inc_netcon(5),prop4_3_inc_netcon(8),prop4_3_inc_netcon(6),prop4_3_inc_netcon(9)],...
%     [prop4_3_inc_netcon(10),prop4_3_inc_netcon(8),prop4_3_inc_netcon(11),prop4_3_inc_netcon(9)],...
%     [-4,prop4_3_inc_netcon(7),prop4_3_inc_netcon(10)],...
%     [-6,prop4_3_inc_netcon(11),prop4_3_inc_netcon(4)]};
%
% prop4_4_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[1,7,5,8,6,9,4,10],[11,8,12,9],[-2,7,11],[-4,12,10]},0,2,1,1)) = 1:12;
% prop4_4_inc_order = {[-1,prop4_4_inc_netcon(1),prop4_4_inc_netcon(2)],...
%     [-3,prop4_4_inc_netcon(3),prop4_4_inc_netcon(4)],...
%     [prop4_4_inc_netcon(2),prop4_4_inc_netcon(5),prop4_4_inc_netcon(3),prop4_4_inc_netcon(6)],...
%     [prop4_4_inc_netcon(1),prop4_4_inc_netcon(7),prop4_4_inc_netcon(5),prop4_4_inc_netcon(8),prop4_4_inc_netcon(6),prop4_4_inc_netcon(9),prop4_4_inc_netcon(4),prop4_4_inc_netcon(10)],...
%     [prop4_4_inc_netcon(11),prop4_4_inc_netcon(8),prop4_4_inc_netcon(12),prop4_4_inc_netcon(9)],...
%     [-2,prop4_4_inc_netcon(7),prop4_4_inc_netcon(11)],...
%     [-4,prop4_4_inc_netcon(12),prop4_4_inc_netcon(10)]};
%
% prop4_5_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[5,7,6,8,4,9,-5,-6],[10,7,11,8],[-2,1,10],[-4,11,9]},0,2,1,1)) = 1:11;
% prop4_5_inc_order = {[-1,prop4_5_inc_netcon(1),prop4_5_inc_netcon(2)],...
%     [-3,prop4_5_inc_netcon(3),prop4_5_inc_netcon(4)],...
%     [prop4_5_inc_netcon(2),prop4_5_inc_netcon(5),prop4_5_inc_netcon(3),prop4_5_inc_netcon(6)],...
%     [prop4_5_inc_netcon(5),prop4_5_inc_netcon(7),prop4_5_inc_netcon(6),prop4_5_inc_netcon(8),prop4_5_inc_netcon(4),prop4_5_inc_netcon(9),-5,-6],...
%     [prop4_5_inc_netcon(10),prop4_5_inc_netcon(7),prop4_5_inc_netcon(11),prop4_5_inc_netcon(8)],...
%     [-2,prop4_5_inc_netcon(1),prop4_5_inc_netcon(10)],...
%     [-4,prop4_5_inc_netcon(11),prop4_5_inc_netcon(9)]};
%
% prop4_6_inc_netcon(netcon({[-1,1,2],[-3,3,4],[2,5,3,6],[6,7,4,8,-5,-6,-7,-8],[9,5,10,7],[-2,1,9],[-4,10,8]},0,2,1,1)) = 1:10;
% prop4_6_inc_order = {[-1,prop4_6_inc_netcon(1),prop4_6_inc_netcon(2)],...
%     [-3,prop4_6_inc_netcon(3),prop4_6_inc_netcon(4)],...
%     [prop4_6_inc_netcon(2),prop4_6_inc_netcon(5),prop4_6_inc_netcon(3),prop4_6_inc_netcon(6)],...
%     [prop4_6_inc_netcon(6),prop4_6_inc_netcon(7),prop4_6_inc_netcon(4),prop4_6_inc_netcon(8),-5,-6,-7,-8],...
%     [prop4_6_inc_netcon(9),prop4_6_inc_netcon(5),prop4_6_inc_netcon(10),prop4_6_inc_netcon(7)],...
%     [-2,prop4_6_inc_netcon(1),prop4_6_inc_netcon(9)],...
%     [-4,prop4_6_inc_netcon(10),prop4_6_inc_netcon(8)]};
%
% prop4_7_inc_netcon(netcon({[-1,1,2],[2,3,-3,-4,-5,-6,-7,-8],[-2,1,3]},0,2,1,1)) = 1:3;
% prop4_7_inc_order = {[-1,prop4_7_inc_netcon(1),prop4_7_inc_netcon(2)],...
%     [prop4_7_inc_netcon(2),prop4_7_inc_netcon(3),-3,-4,-5,-6,-7,-8],...
%     [-2,prop4_7_inc_netcon(1),prop4_7_inc_netcon(3)]};
%
% prop4_PBC6_inc_netcon(netcon({[-3,1,2],[-5,3,4],[4,6,-7,-8,-1,-2,1,5],[-4,5,2],[-6,3,6]},0,2,1,1)) = 1:6;
% prop4_PBC6_inc_order = {[-3,prop4_PBC6_inc_netcon(1),prop4_PBC6_inc_netcon(2)],...
%     [-5,prop4_PBC6_inc_netcon(3),prop4_PBC6_inc_netcon(4)],...
%     [prop4_PBC6_inc_netcon(4),prop4_PBC6_inc_netcon(6),-7,-8,-1,-2,prop4_PBC6_inc_netcon(1),prop4_PBC6_inc_netcon(5)],...
%     [-4,prop4_PBC6_inc_netcon(5),prop4_PBC6_inc_netcon(2)],...
%     [-6,prop4_PBC6_inc_netcon(3),prop4_PBC6_inc_netcon(6)]};
% 
% corr_PBC1_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[9,13,10,14],[11,15,12,16],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% corr_PBC1_at_order = {[corr_PBC1_at_netcon(1),corr_PBC1_at_netcon(2)],...
%     [corr_PBC1_at_netcon(3),corr_PBC1_at_netcon(4)],...
%     [corr_PBC1_at_netcon(4),corr_PBC1_at_netcon(5),corr_PBC1_at_netcon(1),corr_PBC1_at_netcon(6)],...
%     [corr_PBC1_at_netcon(2),corr_PBC1_at_netcon(7),corr_PBC1_at_netcon(3),corr_PBC1_at_netcon(8)],...
%     [corr_PBC1_at_netcon(6),corr_PBC1_at_netcon(10),corr_PBC1_at_netcon(7),corr_PBC1_at_netcon(11)],...
%     [corr_PBC1_at_netcon(8),corr_PBC1_at_netcon(12),corr_PBC1_at_netcon(5),corr_PBC1_at_netcon(9)],...
%     [corr_PBC1_at_netcon(9),corr_PBC1_at_netcon(13),corr_PBC1_at_netcon(10),corr_PBC1_at_netcon(14)],...
%     [corr_PBC1_at_netcon(11),corr_PBC1_at_netcon(15),corr_PBC1_at_netcon(12),corr_PBC1_at_netcon(16)],...
%     [corr_PBC1_at_netcon(18),corr_PBC1_at_netcon(14),corr_PBC1_at_netcon(19),corr_PBC1_at_netcon(15)],...
%     [corr_PBC1_at_netcon(20),corr_PBC1_at_netcon(16),corr_PBC1_at_netcon(17),corr_PBC1_at_netcon(13)],...
%     [corr_PBC1_at_netcon(24),corr_PBC1_at_netcon(17),corr_PBC1_at_netcon(21),corr_PBC1_at_netcon(18)],...
%     [corr_PBC1_at_netcon(22),corr_PBC1_at_netcon(19),corr_PBC1_at_netcon(23),corr_PBC1_at_netcon(20)],...
%     [corr_PBC1_at_netcon(21),corr_PBC1_at_netcon(22)],...
%     [corr_PBC1_at_netcon(23),corr_PBC1_at_netcon(24)]};
% 
% corr_PBC2_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[10,14,11,15],[12,16,9,13],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% corr_PBC2_at_order = {[corr_PBC1_at_netcon(1),corr_PBC1_at_netcon(2)],...
%     [corr_PBC1_at_netcon(3),corr_PBC1_at_netcon(4)],...
%     [corr_PBC1_at_netcon(4),corr_PBC1_at_netcon(5),corr_PBC1_at_netcon(1),corr_PBC1_at_netcon(6)],...
%     [corr_PBC1_at_netcon(2),corr_PBC1_at_netcon(7),corr_PBC1_at_netcon(3),corr_PBC1_at_netcon(8)],...
%     [corr_PBC1_at_netcon(6),corr_PBC1_at_netcon(10),corr_PBC1_at_netcon(7),corr_PBC1_at_netcon(11)],...
%     [corr_PBC1_at_netcon(8),corr_PBC1_at_netcon(12),corr_PBC1_at_netcon(5),corr_PBC1_at_netcon(9)],...
%     [corr_PBC1_at_netcon(10),corr_PBC1_at_netcon(14),corr_PBC1_at_netcon(11),corr_PBC1_at_netcon(15)],...
%     [corr_PBC1_at_netcon(12),corr_PBC1_at_netcon(16),corr_PBC1_at_netcon(9),corr_PBC1_at_netcon(13)],...
%     [corr_PBC1_at_netcon(18),corr_PBC1_at_netcon(14),corr_PBC1_at_netcon(19),corr_PBC1_at_netcon(15)],...
%     [corr_PBC1_at_netcon(20),corr_PBC1_at_netcon(16),corr_PBC1_at_netcon(17),corr_PBC1_at_netcon(13)],...
%     [corr_PBC1_at_netcon(24),corr_PBC1_at_netcon(17),corr_PBC1_at_netcon(21),corr_PBC1_at_netcon(18)],...
%     [corr_PBC1_at_netcon(22),corr_PBC1_at_netcon(19),corr_PBC1_at_netcon(23),corr_PBC1_at_netcon(20)],...
%     [corr_PBC1_at_netcon(21),corr_PBC1_at_netcon(22)],...
%     [corr_PBC1_at_netcon(23),corr_PBC1_at_netcon(24)]};
% 
% h_PBC1_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[8,10,5,9],[10,12,9,11],[14,12,13,11],[18,13,15,6],[16,7,17,14],[15,16],[17,18]},0,2,1,1)) = 1:18;
% h_PBC1_at_order = {[h_PBC1_at_netcon(1),h_PBC1_at_netcon(2)],...
%     [h_PBC1_at_netcon(3),h_PBC1_at_netcon(4)],...
%     [h_PBC1_at_netcon(4),h_PBC1_at_netcon(5),h_PBC1_at_netcon(1),h_PBC1_at_netcon(6)],...
%     [h_PBC1_at_netcon(2),h_PBC1_at_netcon(7),h_PBC1_at_netcon(3),h_PBC1_at_netcon(8)],...
%     [h_PBC1_at_netcon(8),h_PBC1_at_netcon(10),h_PBC1_at_netcon(5),h_PBC1_at_netcon(9)],...
%     [h_PBC1_at_netcon(10),h_PBC1_at_netcon(12),h_PBC1_at_netcon(9),h_PBC1_at_netcon(11)],...
%     [h_PBC1_at_netcon(14),h_PBC1_at_netcon(12),h_PBC1_at_netcon(13),h_PBC1_at_netcon(11)],...
%     [h_PBC1_at_netcon(18),h_PBC1_at_netcon(13),h_PBC1_at_netcon(15),h_PBC1_at_netcon(6)],...
%     [h_PBC1_at_netcon(16),h_PBC1_at_netcon(7),h_PBC1_at_netcon(17),h_PBC1_at_netcon(14)],...
%     [h_PBC1_at_netcon(15),h_PBC1_at_netcon(16)],...
%     [h_PBC1_at_netcon(17),h_PBC1_at_netcon(18)]};
% 
% h_PBC2_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[9,13,10,14],[16,14,17,11],[18,12,15,13],[22,15,19,16],[20,17,21,18],[19,20],[21,22]},0,2,1,1)) = 1:22;
% h_PBC2_at_order = {[h_PBC2_at_netcon(1),h_PBC2_at_netcon(2)],...
%     [h_PBC2_at_netcon(3),h_PBC2_at_netcon(4)],...
%     [h_PBC2_at_netcon(4),h_PBC2_at_netcon(5),h_PBC2_at_netcon(1),h_PBC2_at_netcon(6)],...
%     [h_PBC2_at_netcon(2),h_PBC2_at_netcon(7),h_PBC2_at_netcon(3),h_PBC2_at_netcon(8)],...
%     [h_PBC2_at_netcon(6),h_PBC2_at_netcon(10),h_PBC2_at_netcon(7),h_PBC2_at_netcon(11)],...
%     [h_PBC2_at_netcon(8),h_PBC2_at_netcon(12),h_PBC2_at_netcon(5),h_PBC2_at_netcon(9)],...
%     [h_PBC2_at_netcon(9),h_PBC2_at_netcon(13),h_PBC2_at_netcon(10),h_PBC2_at_netcon(14)],...
%     [h_PBC2_at_netcon(16),h_PBC2_at_netcon(14),h_PBC2_at_netcon(17),h_PBC2_at_netcon(11)],...
%     [h_PBC2_at_netcon(18),h_PBC2_at_netcon(12),h_PBC2_at_netcon(15),h_PBC2_at_netcon(13)],...
%     [h_PBC2_at_netcon(22),h_PBC2_at_netcon(15),h_PBC2_at_netcon(19),h_PBC2_at_netcon(16)],...
%     [h_PBC2_at_netcon(20),h_PBC2_at_netcon(17),h_PBC2_at_netcon(21),h_PBC2_at_netcon(18)],...
%     [h_PBC2_at_netcon(19),h_PBC2_at_netcon(20)],...
%     [h_PBC2_at_netcon(21),h_PBC2_at_netcon(22)]};
% 
% h_PBC3_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,9,7,10],[9,11,10,12],[13,11,14,12],[18,5,15,13],[16,14,17,8],[15,16],[17,18]},0,2,1,1)) = 1:18;
% h_PBC3_at_order = {[h_PBC3_at_netcon(1),h_PBC3_at_netcon(2)],...
%     [h_PBC3_at_netcon(3),h_PBC3_at_netcon(4)],...
%     [h_PBC3_at_netcon(4),h_PBC3_at_netcon(5),h_PBC3_at_netcon(1),h_PBC3_at_netcon(6)],...
%     [h_PBC3_at_netcon(2),h_PBC3_at_netcon(7),h_PBC3_at_netcon(3),h_PBC3_at_netcon(8)],...
%     [h_PBC3_at_netcon(6),h_PBC3_at_netcon(9),h_PBC3_at_netcon(7),h_PBC3_at_netcon(10)],...
%     [h_PBC3_at_netcon(9),h_PBC3_at_netcon(11),h_PBC3_at_netcon(10),h_PBC3_at_netcon(12)],...
%     [h_PBC3_at_netcon(13),h_PBC3_at_netcon(11),h_PBC3_at_netcon(14),h_PBC3_at_netcon(12)],...
%     [h_PBC3_at_netcon(18),h_PBC3_at_netcon(5),h_PBC3_at_netcon(15),h_PBC3_at_netcon(13)],...
%     [h_PBC3_at_netcon(16),h_PBC3_at_netcon(14),h_PBC3_at_netcon(17),h_PBC3_at_netcon(8)],...
%     [h_PBC3_at_netcon(15),h_PBC3_at_netcon(16)],...
%     [h_PBC3_at_netcon(17),h_PBC3_at_netcon(18)]};
% 
% h_PBC4_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[11,13,12,14],[16,10,17,13],[18,14,15,9],[22,15,19,16],[20,17,21,18],[19,20],[21,22]},0,2,1,1)) = 1:22;
% h_PBC4_at_order = {[h_PBC4_at_netcon(1),h_PBC4_at_netcon(2)],...
%     [h_PBC4_at_netcon(3),h_PBC4_at_netcon(4)],...
%     [h_PBC4_at_netcon(4),h_PBC4_at_netcon(5),h_PBC4_at_netcon(1),h_PBC4_at_netcon(6)],...
%     [h_PBC4_at_netcon(2),h_PBC4_at_netcon(7),h_PBC4_at_netcon(3),h_PBC4_at_netcon(8)],...
%     [h_PBC4_at_netcon(6),h_PBC4_at_netcon(10),h_PBC4_at_netcon(7),h_PBC4_at_netcon(11)],...
%     [h_PBC4_at_netcon(8),h_PBC4_at_netcon(12),h_PBC4_at_netcon(5),h_PBC4_at_netcon(9)],...
%     [h_PBC4_at_netcon(11),h_PBC4_at_netcon(13),h_PBC4_at_netcon(12),h_PBC4_at_netcon(14)],...
%     [h_PBC4_at_netcon(16),h_PBC4_at_netcon(10),h_PBC4_at_netcon(17),h_PBC4_at_netcon(13)],...
%     [h_PBC4_at_netcon(18),h_PBC4_at_netcon(14),h_PBC4_at_netcon(15),h_PBC4_at_netcon(9)],...
%     [h_PBC4_at_netcon(22),h_PBC4_at_netcon(15),h_PBC4_at_netcon(19),h_PBC4_at_netcon(16)],...
%     [h_PBC4_at_netcon(20),h_PBC4_at_netcon(17),h_PBC4_at_netcon(21),h_PBC4_at_netcon(18)],...
%     [h_PBC4_at_netcon(19),h_PBC4_at_netcon(20)],...
%     [h_PBC4_at_netcon(21),h_PBC4_at_netcon(22)]};
% 
% prop3_PBC1_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[11,14,12,15,9,13],[17,10,18,14],[19,15,16,13],[23,16,20,17],[21,18,22,19],[20,21],[22,23]},0,2,1,1)) = 1:23;
% prop3_PBC1_at_order = {[prop3_PBC1_at_netcon(1),prop3_PBC1_at_netcon(2)],...
%     [prop3_PBC1_at_netcon(3),prop3_PBC1_at_netcon(4)],...
%     [prop3_PBC1_at_netcon(4),prop3_PBC1_at_netcon(5),prop3_PBC1_at_netcon(1),prop3_PBC1_at_netcon(6)],...
%     [prop3_PBC1_at_netcon(2),prop3_PBC1_at_netcon(7),prop3_PBC1_at_netcon(3),prop3_PBC1_at_netcon(8)],...
%     [prop3_PBC1_at_netcon(6),prop3_PBC1_at_netcon(10),prop3_PBC1_at_netcon(7),prop3_PBC1_at_netcon(11)],...
%     [prop3_PBC1_at_netcon(8),prop3_PBC1_at_netcon(12),prop3_PBC1_at_netcon(5),prop3_PBC1_at_netcon(9)],...
%     [prop3_PBC1_at_netcon(11),prop3_PBC1_at_netcon(14),prop3_PBC1_at_netcon(12),prop3_PBC1_at_netcon(15),prop3_PBC1_at_netcon(9),prop3_PBC1_at_netcon(13)],...
%     [prop3_PBC1_at_netcon(17),prop3_PBC1_at_netcon(10),prop3_PBC1_at_netcon(18),prop3_PBC1_at_netcon(14)],...
%     [prop3_PBC1_at_netcon(19),prop3_PBC1_at_netcon(15),prop3_PBC1_at_netcon(16),prop3_PBC1_at_netcon(13)],...
%     [prop3_PBC1_at_netcon(23),prop3_PBC1_at_netcon(16),prop3_PBC1_at_netcon(20),prop3_PBC1_at_netcon(17)],...
%     [prop3_PBC1_at_netcon(21),prop3_PBC1_at_netcon(18),prop3_PBC1_at_netcon(22),prop3_PBC1_at_netcon(19)],...
%     [prop3_PBC1_at_netcon(20),prop3_PBC1_at_netcon(21)],...
%     [prop3_PBC1_at_netcon(22),prop3_PBC1_at_netcon(23)]};
% 
% prop3_PBC2_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[12,15,9,13,10,14],[17,14,18,11],[19,15,16,13],[23,16,20,17],[21,18,22,19],[20,21],[22,23]},0,2,1,1)) = 1:23;
% prop3_PBC2_at_order = {[prop3_PBC2_at_netcon(1),prop3_PBC2_at_netcon(2)],...
%     [prop3_PBC2_at_netcon(3),prop3_PBC2_at_netcon(4)],...
%     [prop3_PBC2_at_netcon(4),prop3_PBC2_at_netcon(5),prop3_PBC2_at_netcon(1),prop3_PBC2_at_netcon(6)],...
%     [prop3_PBC2_at_netcon(2),prop3_PBC2_at_netcon(7),prop3_PBC2_at_netcon(3),prop3_PBC2_at_netcon(8)],...
%     [prop3_PBC2_at_netcon(6),prop3_PBC2_at_netcon(10),prop3_PBC2_at_netcon(7),prop3_PBC2_at_netcon(11)],...
%     [prop3_PBC2_at_netcon(8),prop3_PBC2_at_netcon(12),prop3_PBC2_at_netcon(5),prop3_PBC2_at_netcon(9)],...
%     [prop3_PBC2_at_netcon(12),prop3_PBC2_at_netcon(15),prop3_PBC2_at_netcon(9),prop3_PBC2_at_netcon(13),prop3_PBC2_at_netcon(10),prop3_PBC2_at_netcon(14)],...
%     [prop3_PBC2_at_netcon(17),prop3_PBC2_at_netcon(14),prop3_PBC2_at_netcon(18),prop3_PBC2_at_netcon(11)],...
%     [prop3_PBC2_at_netcon(19),prop3_PBC2_at_netcon(15),prop3_PBC2_at_netcon(16),prop3_PBC2_at_netcon(13)],...
%     [prop3_PBC2_at_netcon(23),prop3_PBC2_at_netcon(16),prop3_PBC2_at_netcon(20),prop3_PBC2_at_netcon(17)],...
%     [prop3_PBC2_at_netcon(21),prop3_PBC2_at_netcon(18),prop3_PBC2_at_netcon(22),prop3_PBC2_at_netcon(19)],...
%     [prop3_PBC2_at_netcon(20),prop3_PBC2_at_netcon(21)],...
%     [prop3_PBC2_at_netcon(22),prop3_PBC2_at_netcon(23)]};
% 
% prop3_PBC3_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[9,13,10,14,11,15],[17,14,18,15],[19,12,16,13],[23,16,20,17],[21,18,22,19],[20,21],[22,23]},0,2,1,1)) = 1:23;
% prop3_PBC3_at_order = {[prop3_PBC3_at_netcon(1),prop3_PBC3_at_netcon(2)],...
%     [prop3_PBC3_at_netcon(3),prop3_PBC3_at_netcon(4)],...
%     [prop3_PBC3_at_netcon(4),prop3_PBC3_at_netcon(5),prop3_PBC3_at_netcon(1),prop3_PBC3_at_netcon(6)],...
%     [prop3_PBC3_at_netcon(2),prop3_PBC3_at_netcon(7),prop3_PBC3_at_netcon(3),prop3_PBC3_at_netcon(8)],...
%     [prop3_PBC3_at_netcon(6),prop3_PBC3_at_netcon(10),prop3_PBC3_at_netcon(7),prop3_PBC3_at_netcon(11)],...
%     [prop3_PBC3_at_netcon(8),prop3_PBC3_at_netcon(12),prop3_PBC3_at_netcon(5),prop3_PBC3_at_netcon(9)],...
%     [prop3_PBC3_at_netcon(9),prop3_PBC3_at_netcon(13),prop3_PBC3_at_netcon(10),prop3_PBC3_at_netcon(14),prop3_PBC3_at_netcon(11),prop3_PBC3_at_netcon(15)],...
%     [prop3_PBC3_at_netcon(17),prop3_PBC3_at_netcon(14),prop3_PBC3_at_netcon(18),prop3_PBC3_at_netcon(15)],...
%     [prop3_PBC3_at_netcon(19),prop3_PBC3_at_netcon(12),prop3_PBC3_at_netcon(16),prop3_PBC3_at_netcon(13)],...
%     [prop3_PBC3_at_netcon(23),prop3_PBC3_at_netcon(16),prop3_PBC3_at_netcon(20),prop3_PBC3_at_netcon(17)],...
%     [prop3_PBC3_at_netcon(21),prop3_PBC3_at_netcon(18),prop3_PBC3_at_netcon(22),prop3_PBC3_at_netcon(19)],...
%     [prop3_PBC3_at_netcon(20),prop3_PBC3_at_netcon(21)],...
%     [prop3_PBC3_at_netcon(22),prop3_PBC3_at_netcon(23)]};
% 
% prop3_PBC4_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[10,13,11,14,12,15],[17,13,18,14],[19,15,16,9],[23,16,20,17],[21,18,22,19],[20,21],[22,23]},0,2,1,1)) = 1:23;
% prop3_PBC4_at_order = {[prop3_PBC4_at_netcon(1),prop3_PBC4_at_netcon(2)],...
%     [prop3_PBC4_at_netcon(3),prop3_PBC4_at_netcon(4)],...
%     [prop3_PBC4_at_netcon(4),prop3_PBC4_at_netcon(5),prop3_PBC4_at_netcon(1),prop3_PBC4_at_netcon(6)],...
%     [prop3_PBC4_at_netcon(2),prop3_PBC4_at_netcon(7),prop3_PBC4_at_netcon(3),prop3_PBC4_at_netcon(8)],...
%     [prop3_PBC4_at_netcon(6),prop3_PBC4_at_netcon(10),prop3_PBC4_at_netcon(7),prop3_PBC4_at_netcon(11)],...
%     [prop3_PBC4_at_netcon(8),prop3_PBC4_at_netcon(12),prop3_PBC4_at_netcon(5),prop3_PBC4_at_netcon(9)],...
%     [prop3_PBC4_at_netcon(10),prop3_PBC4_at_netcon(13),prop3_PBC4_at_netcon(11),prop3_PBC4_at_netcon(14),prop3_PBC4_at_netcon(12),prop3_PBC4_at_netcon(15)],...
%     [prop3_PBC4_at_netcon(17),prop3_PBC4_at_netcon(13),prop3_PBC4_at_netcon(18),prop3_PBC4_at_netcon(14)],...
%     [prop3_PBC4_at_netcon(19),prop3_PBC4_at_netcon(15),prop3_PBC4_at_netcon(16),prop3_PBC4_at_netcon(9)],...
%     [prop3_PBC4_at_netcon(23),prop3_PBC4_at_netcon(16),prop3_PBC4_at_netcon(20),prop3_PBC4_at_netcon(17)],...
%     [prop3_PBC4_at_netcon(21),prop3_PBC4_at_netcon(18),prop3_PBC4_at_netcon(22),prop3_PBC4_at_netcon(19)],...
%     [prop3_PBC4_at_netcon(20),prop3_PBC4_at_netcon(21)],...
%     [prop3_PBC4_at_netcon(22),prop3_PBC4_at_netcon(23)]};
% 
% prop4_PBC1_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[10,14,11,15,12,16,9,13],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% prop4_PBC1_at_order = {[prop4_PBC1_at_netcon(1),prop4_PBC1_at_netcon(2)],...
%     [prop4_PBC1_at_netcon(3),prop4_PBC1_at_netcon(4)],...
%     [prop4_PBC1_at_netcon(4),prop4_PBC1_at_netcon(5),prop4_PBC1_at_netcon(1),prop4_PBC1_at_netcon(6)],...
%     [prop4_PBC1_at_netcon(2),prop4_PBC1_at_netcon(7),prop4_PBC1_at_netcon(3),prop4_PBC1_at_netcon(8)],...
%     [prop4_PBC1_at_netcon(6),prop4_PBC1_at_netcon(10),prop4_PBC1_at_netcon(7),prop4_PBC1_at_netcon(11)],...
%     [prop4_PBC1_at_netcon(8),prop4_PBC1_at_netcon(12),prop4_PBC1_at_netcon(5),prop4_PBC1_at_netcon(9)],...
%     [prop4_PBC1_at_netcon(10),prop4_PBC1_at_netcon(14),prop4_PBC1_at_netcon(11),prop4_PBC1_at_netcon(15),prop4_PBC1_at_netcon(12),prop4_PBC1_at_netcon(16),prop4_PBC1_at_netcon(9),prop4_PBC1_at_netcon(13)],...
%     [prop4_PBC1_at_netcon(18),prop4_PBC1_at_netcon(14),prop4_PBC1_at_netcon(19),prop4_PBC1_at_netcon(15)],...
%     [prop4_PBC1_at_netcon(20),prop4_PBC1_at_netcon(16),prop4_PBC1_at_netcon(17),prop4_PBC1_at_netcon(13)],...
%     [prop4_PBC1_at_netcon(24),prop4_PBC1_at_netcon(17),prop4_PBC1_at_netcon(21),prop4_PBC1_at_netcon(18)],...
%     [prop4_PBC1_at_netcon(22),prop4_PBC1_at_netcon(19),prop4_PBC1_at_netcon(23),prop4_PBC1_at_netcon(20)],...
%     [prop4_PBC1_at_netcon(21),prop4_PBC1_at_netcon(22)],...
%     [prop4_PBC1_at_netcon(23),prop4_PBC1_at_netcon(24)]};
% 
% prop4_PBC2_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[11,15,12,16,9,13,10,14],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% prop4_PBC2_at_order = {[prop4_PBC2_at_netcon(1),prop4_PBC2_at_netcon(2)],...
%     [prop4_PBC2_at_netcon(3),prop4_PBC2_at_netcon(4)],...
%     [prop4_PBC2_at_netcon(4),prop4_PBC2_at_netcon(5),prop4_PBC2_at_netcon(1),prop4_PBC2_at_netcon(6)],...
%     [prop4_PBC2_at_netcon(2),prop4_PBC2_at_netcon(7),prop4_PBC2_at_netcon(3),prop4_PBC2_at_netcon(8)],...
%     [prop4_PBC2_at_netcon(6),prop4_PBC2_at_netcon(10),prop4_PBC2_at_netcon(7),prop4_PBC2_at_netcon(11)],...
%     [prop4_PBC2_at_netcon(8),prop4_PBC2_at_netcon(12),prop4_PBC2_at_netcon(5),prop4_PBC2_at_netcon(9)],...
%     [prop4_PBC2_at_netcon(11),prop4_PBC2_at_netcon(15),prop4_PBC2_at_netcon(12),prop4_PBC2_at_netcon(16),prop4_PBC2_at_netcon(9),prop4_PBC2_at_netcon(13),prop4_PBC2_at_netcon(10),prop4_PBC2_at_netcon(14)],...
%     [prop4_PBC2_at_netcon(18),prop4_PBC2_at_netcon(14),prop4_PBC2_at_netcon(19),prop4_PBC2_at_netcon(15)],...
%     [prop4_PBC2_at_netcon(20),prop4_PBC2_at_netcon(16),prop4_PBC2_at_netcon(17),prop4_PBC2_at_netcon(13)],...
%     [prop4_PBC2_at_netcon(24),prop4_PBC2_at_netcon(17),prop4_PBC2_at_netcon(21),prop4_PBC2_at_netcon(18)],...
%     [prop4_PBC2_at_netcon(22),prop4_PBC2_at_netcon(19),prop4_PBC2_at_netcon(23),prop4_PBC2_at_netcon(20)],...
%     [prop4_PBC2_at_netcon(21),prop4_PBC2_at_netcon(22)],...
%     [prop4_PBC2_at_netcon(23),prop4_PBC2_at_netcon(24)]};
% 
% prop4_PBC3_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[12,16,9,13,10,14,11,15],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% prop4_PBC3_at_order = {[prop4_PBC3_at_netcon(1),prop4_PBC3_at_netcon(2)],...
%     [prop4_PBC3_at_netcon(3),prop4_PBC3_at_netcon(4)],...
%     [prop4_PBC3_at_netcon(4),prop4_PBC3_at_netcon(5),prop4_PBC3_at_netcon(1),prop4_PBC3_at_netcon(6)],...
%     [prop4_PBC3_at_netcon(2),prop4_PBC3_at_netcon(7),prop4_PBC3_at_netcon(3),prop4_PBC3_at_netcon(8)],...
%     [prop4_PBC3_at_netcon(6),prop4_PBC3_at_netcon(10),prop4_PBC3_at_netcon(7),prop4_PBC3_at_netcon(11)],...
%     [prop4_PBC3_at_netcon(8),prop4_PBC3_at_netcon(12),prop4_PBC3_at_netcon(5),prop4_PBC3_at_netcon(9)],...
%     [prop4_PBC3_at_netcon(12),prop4_PBC3_at_netcon(16),prop4_PBC3_at_netcon(9),prop4_PBC3_at_netcon(13),prop4_PBC3_at_netcon(10),prop4_PBC3_at_netcon(14),prop4_PBC3_at_netcon(11),prop4_PBC3_at_netcon(15)],...
%     [prop4_PBC3_at_netcon(18),prop4_PBC3_at_netcon(14),prop4_PBC3_at_netcon(19),prop4_PBC3_at_netcon(15)],...
%     [prop4_PBC3_at_netcon(20),prop4_PBC3_at_netcon(16),prop4_PBC3_at_netcon(17),prop4_PBC3_at_netcon(13)],...
%     [prop4_PBC3_at_netcon(24),prop4_PBC3_at_netcon(17),prop4_PBC3_at_netcon(21),prop4_PBC3_at_netcon(18)],...
%     [prop4_PBC3_at_netcon(22),prop4_PBC3_at_netcon(19),prop4_PBC3_at_netcon(23),prop4_PBC3_at_netcon(20)],...
%     [prop4_PBC3_at_netcon(21),prop4_PBC3_at_netcon(22)],...
%     [prop4_PBC3_at_netcon(23),prop4_PBC3_at_netcon(24)]};
% 
% prop4_PBC4_at_netcon(netcon({[1,2],[3,4],[4,5,1,6],[2,7,3,8],[6,10,7,11],[8,12,5,9],[9,13,10,14,11,15,12,16],[18,14,19,15],[20,16,17,13],[24,17,21,18],[22,19,23,20],[21,22],[23,24]},0,2,1,1)) = 1:24;
% prop4_PBC4_at_order = {[prop4_PBC4_at_netcon(1),prop4_PBC4_at_netcon(2)],...
%     [prop4_PBC4_at_netcon(3),prop4_PBC4_at_netcon(4)],...
%     [prop4_PBC4_at_netcon(4),prop4_PBC4_at_netcon(5),prop4_PBC4_at_netcon(1),prop4_PBC4_at_netcon(6)],...
%     [prop4_PBC4_at_netcon(2),prop4_PBC4_at_netcon(7),prop4_PBC4_at_netcon(3),prop4_PBC4_at_netcon(8)],...
%     [prop4_PBC4_at_netcon(6),prop4_PBC4_at_netcon(10),prop4_PBC4_at_netcon(7),prop4_PBC4_at_netcon(11)],...
%     [prop4_PBC4_at_netcon(8),prop4_PBC4_at_netcon(12),prop4_PBC4_at_netcon(5),prop4_PBC4_at_netcon(9)],...
%     [prop4_PBC4_at_netcon(9),prop4_PBC4_at_netcon(13),prop4_PBC4_at_netcon(10),prop4_PBC4_at_netcon(14),prop4_PBC4_at_netcon(11),prop4_PBC4_at_netcon(15),prop4_PBC4_at_netcon(12),prop4_PBC4_at_netcon(16)],...
%     [prop4_PBC4_at_netcon(18),prop4_PBC4_at_netcon(14),prop4_PBC4_at_netcon(19),prop4_PBC4_at_netcon(15)],...
%     [prop4_PBC4_at_netcon(20),prop4_PBC4_at_netcon(16),prop4_PBC4_at_netcon(17),prop4_PBC4_at_netcon(13)],...
%     [prop4_PBC4_at_netcon(24),prop4_PBC4_at_netcon(17),prop4_PBC4_at_netcon(21),prop4_PBC4_at_netcon(18)],...
%     [prop4_PBC4_at_netcon(22),prop4_PBC4_at_netcon(19),prop4_PBC4_at_netcon(23),prop4_PBC4_at_netcon(20)],...
%     [prop4_PBC4_at_netcon(21),prop4_PBC4_at_netcon(22)],...
%     [prop4_PBC4_at_netcon(23),prop4_PBC4_at_netcon(24)]};